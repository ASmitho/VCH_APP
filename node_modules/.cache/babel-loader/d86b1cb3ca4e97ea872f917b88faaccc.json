{"ast":null,"code":"import _regeneratorRuntime from \"C:\\\\Users\\\\Alika\\\\Desktop\\\\VCH_APP\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";\nimport _asyncToGenerator from \"C:\\\\Users\\\\Alika\\\\Desktop\\\\VCH_APP\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"C:\\\\Users\\\\Alika\\\\Desktop\\\\VCH_APP\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:\\\\Users\\\\Alika\\\\Desktop\\\\VCH_APP\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"C:\\\\Users\\\\Alika\\\\Desktop\\\\VCH_APP\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"C:\\\\Users\\\\Alika\\\\Desktop\\\\VCH_APP\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"C:\\\\Users\\\\Alika\\\\Desktop\\\\VCH_APP\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"C:\\\\Users\\\\Alika\\\\Desktop\\\\VCH_APP\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"C:\\\\Users\\\\Alika\\\\Desktop\\\\VCH_APP\\\\src\\\\containers\\\\TrialQ.js\";\nimport React, { Component } from 'react';\nimport './Trial.css';\nimport { Redirect } from \"react-router-dom\";\nimport { createStim, createGabor } from \"../Stim.js\";\nimport { QuestCreate, QuestRecompute, QuestTrials, QuestUpdate, QuestStimulate, QuestMean, QuestMode, QuestSd, QuestP, QuestPdf, QuestQuantile, PAL_Gumbel } from \"../Quest.js\";\nimport { connect } from 'react-redux';\nimport { add_array as _add_array, add_response_1 as _add_response_, add_response_time_1 as _add_response_time_, add_contrast_1 as _add_contrast_ } from '../actions/data';\n\nvar TrialQ =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(TrialQ, _Component);\n\n  function TrialQ(props) {\n    var _this;\n\n    _classCallCheck(this, TrialQ);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(TrialQ).call(this, props));\n    _this.keyFunction = _this.keyFunction.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.create_noise = _this.create_noise.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.state = {\n      continue: false,\n      counter: 0,\n      counter2: 0,\n      change: false,\n      responses_1: [],\n      contrast_array_1: [],\n      response_time_1: [],\n      ratings_1: [],\n      responses_2: [],\n      contrast_array_2: [],\n      response_time_2: [],\n      ratings_2: [],\n      time_window: false,\n      time_window_start: 0,\n      time_window_rating: false,\n      limit: 100,\n      rating_window: false,\n      currentQ: 1 //1 for contrast 1 and 2 for contrast 2\n\n    };\n    _this.canvasRef = React.createRef();\n    _this.audioContext = new AudioContext();\n    return _this;\n  }\n\n  _createClass(TrialQ, [{\n    key: \"create_noise\",\n    value: function create_noise(audioContext, callback) {\n      var end = 80; // var contrast_block = tt1;\n\n      var index1 = 0;\n      var index2 = 0;\n      var total = 0; //train_test arrays\n\n      var tt1 = [0, .5, 1, 0, .5, 1, 0, .5, 1, 0, .5, 1];\n      var end = tt1.length;\n      var contrast_block = tt1;\n\n      var SimplexNoise = require('simplex-noise');\n\n      var simplex = new SimplexNoise(),\n          canvas = document.getElementById('c'),\n          ctx = canvas.getContext('2d'),\n          imgdata = ctx.getImageData(0, 0, canvas.width, canvas.height),\n          data = imgdata.data,\n          t = 0; //initializing QUEST\n\n      var tGuess = 0.5,\n          tGuessSd = 0.1,\n          pThreshold = 0.75,\n          beta = 3.5,\n          delta = 0.01,\n          gamma = 0.01,\n          grain = 0.001,\n          dim = 1000,\n          range = 20;\n      var q_1 = QuestCreate(tGuess, tGuessSd, pThreshold, beta, delta, gamma, grain, range);\n      var q_2 = QuestCreate(tGuess, tGuessSd, pThreshold, beta, delta, gamma, grain, range);\n      var stim = createStim();\n      var stimulus_blank = createGabor(stim, 0);\n      var stimulus;\n      var jitter = Math.floor(Math.random() * 20); //jitter tone presentation 0-500ms per trial\n\n      var start_time = 100;\n      var contrast = 0;\n      var intervalId = undefined;\n      var that = this;\n      var seconds = 0;\n\n      function generate_noise() {\n        return _generate_noise.apply(this, arguments);\n      }\n\n      function _generate_noise() {\n        _generate_noise = _asyncToGenerator(\n        /*#__PURE__*/\n        _regeneratorRuntime.mark(function _callee() {\n          var seconds, x, y, img, r, recWidth, recHeight, xPos, yPos;\n          return _regeneratorRuntime.wrap(function _callee$(_context) {\n            while (1) {\n              switch (_context.prev = _context.next) {\n                case 0:\n                  if (t == start_time + jitter) {\n                    index1 = that.state.counter;\n                    index2 = that.state.counter2;\n                    total = index1 + index2;\n                    console.log(QuestQuantile(q_1), QuestQuantile(q_2)); // determining which staircase to use\n\n                    if (index1 == index2) {\n                      that.setState({\n                        //current staircase is 1\n                        currentQ: 1\n                      });\n                    }\n\n                    if (index1 != index2) {\n                      index2++;\n                      that.setState({\n                        //current staircase is 2\n                        currentQ: 2\n                      });\n                    }\n\n                    if (that.state.currentQ == 1) {\n                      if (index1 = 0) {\n                        contrast = tGuess + .3;\n                      } else {\n                        contrast = QuestQuantile(q_1);\n                      }\n                    }\n\n                    if (that.state.currentQ == 2) {\n                      if (index2 = 0) {\n                        contrast = tGuess - 0.3;\n                      } else {\n                        contrast = QuestQuantile(q_2);\n                      }\n                    }\n\n                    console.log(contrast);\n                    seconds = new Date().getTime() / 1000;\n                    console.log(\"time on \", seconds);\n                    that.setState({\n                      time_window: true,\n                      time_window_rating: true,\n                      time_window_start: seconds\n                    });\n                    console.log(\"for 1\", that.state.responses_1, that.state.ratings_1, that.state.response_time_1, that.state.contrast_array_1);\n                    console.log(\"for 2\", that.state.responses_2, that.state.ratings_2, that.state.response_time_2, that.state.contrast_array_2);\n                    stimulus = createGabor(stim, contrast);\n                    beep(50, 830, 300, audioContext); //beep for arg3 miliseconds\n                  }\n\n                  for (x = 0; x < 256; x++) {\n                    for (y = 0; y < 256; y++) {\n                      if (that.state.rating_window == true) {\n                        img = new Image();\n                        img.src = \"data:image/jpeg;base64,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\";\n                      }\n\n                      if (t == start_time + jitter || t == start_time + jitter + 1 || t == start_time + jitter + 2 || t == start_time + jitter + 3 || t == start_time + jitter + 4 || t == start_time + jitter + 5 || t == start_time + jitter + 6 || t == start_time + jitter + 7 || t == start_time + jitter + 8 || t == start_time + jitter + 9 || t == start_time + jitter + 10 || t == start_time + jitter + 11 || t == start_time + jitter + 12 || t == start_time + jitter + 13 || t == start_time + jitter + 14 || t == start_time + jitter + 15 || t == start_time + jitter + 16 || t == start_time + jitter + 17 || t == start_time + jitter + 18 || t == start_time + jitter + 19 || t == start_time + jitter + 20 || t == start_time + jitter + 21 || t == start_time + jitter + 22 || t == start_time + jitter + 23 || t == start_time + jitter + 24 || t == start_time + jitter + 25 || t == start_time + jitter + 26 || t == start_time + jitter + 27 || t == start_time + jitter + 28 || t == start_time + jitter + 29 || t == start_time + jitter + 30) {\n                        if (t == start_time + jitter + 30) {\n                          t = 0; //during beep show signal, then reset timer to 0\n                        }\n\n                        r = simplex.noise3D(x / 8, y / 8, t / 8) * 0.4 + 0.35;\n                        data[(x + y * 256) * 4 + 0] = stim.alpha * stimulus[(x + y * 256) * 4 + 0] + (1 - stim.alpha) * r * 250;\n                        data[(x + y * 256) * 4 + 1] = stim.alpha * stimulus[(x + y * 256) * 4 + 1] + (1 - stim.alpha) * r * 250;\n                        data[(x + y * 256) * 4 + 2] = stim.alpha * stimulus[(x + y * 256) * 4 + 2] + (1 - stim.alpha) * r * 250;\n                        data[(x + y * 256) * 4 + 3] = 255;\n                      } else {\n                        seconds = new Date().getTime() / 1000;\n\n                        if (that.state.time_window_start + 2 == seconds) {\n                          that.setState({\n                            time_window: false,\n                            time_window_rating: false\n                          });\n\n                          if (that.state.currentQ == 1) {\n                            if (that.state.contrast_array_1.length < that.state.responses_1.length) {\n                              that.setState({\n                                contrast_array_1: that.state.contrast_array_1.concat([contrast])\n                              });\n                              that.setState({\n                                change: true\n                              });\n                            }\n\n                            if (that.state.responses_1.length != that.state.ratings_1.length) {\n                              if (that.state.responses_1.length > that.state.ratings_1.length) {\n                                console.log(\"response and response time discarded\", that.state.responses_1, that.state.response_time_1, that.state.ratings_1, that.state.contrast_array_1);\n                                that.setState({\n                                  responses_1: that.state.responses_1.slice(0, that.state.ratings_1.length),\n                                  response_time_1: that.state.response_time_1.slice(0, that.state.ratings_1.length),\n                                  counter: that.state.counter - 1,\n                                  contrast_array_1: that.state.contrast_array_1.slice(0, that.state.ratings_1.length)\n                                });\n                              } else {\n                                console.log(\"rating discarded\", that.state.responses_1, that.state.ratings_1, that.state.contrast_array_1);\n                                that.setState({\n                                  ratings_1: that.state.ratings_1.slice(0, that.state.responses_1.length)\n                                });\n                              }\n                            }\n                          }\n\n                          if (that.state.currentQ == 2) {\n                            if (that.state.contrast_array_2.length < that.state.responses_2.length) {\n                              that.setState({\n                                contrast_array_2: that.state.contrast_array_2.concat([contrast])\n                              });\n                              that.setState({\n                                change: true\n                              });\n                            }\n\n                            if (that.state.responses_2.length != that.state.ratings_2.length) {\n                              if (that.state.responses_2.length > that.state.ratings_2.length) {\n                                console.log(\"response and response time discarded\", that.state.responses_2, that.state.response_time_2, that.state.ratings_2, that.state.contrast_array_2);\n                                that.setState({\n                                  responses_2: that.state.responses_2.slice(0, that.state.ratings_2.length),\n                                  response_time_2: that.state.response_time_2.slice(0, that.state.ratings_2.length),\n                                  counter: that.state.counter - 1,\n                                  contrast_array_2: that.state.contrast_array_2.slice(0, that.state.ratings_2.length)\n                                });\n                              } else {\n                                console.log(\"rating discarded\", that.state.responses_2, that.state.ratings_2, that.state.contrast_array_2);\n                                that.setState({\n                                  ratings_2: that.state.ratings_2.slice(0, that.state.responses_2.length)\n                                });\n                              }\n                            }\n                          }\n\n                          console.log(\"time off \", seconds);\n                        }\n\n                        r = simplex.noise3D(x / 8, y / 8, t / 8) * 0.4 + 0.35;\n                        data[(x + y * 256) * 4 + 0] = stim.alpha * stimulus_blank[(x + y * 256) * 4 + 0] + (1 - stim.alpha) * r * 250;\n                        data[(x + y * 256) * 4 + 1] = stim.alpha * stimulus_blank[(x + y * 256) * 4 + 1] + (1 - stim.alpha) * r * 250;\n                        data[(x + y * 256) * 4 + 2] = stim.alpha * stimulus_blank[(x + y * 256) * 4 + 2] + (1 - stim.alpha) * r * 250;\n                        data[(x + y * 256) * 4 + 3] = 255; //if there is no beep, show blank signal\n                      }\n                    }\n                  }\n\n                  t++;\n                  ctx.putImageData(imgdata, 0, 0);\n                  recWidth = canvas.width / 8;\n                  recHeight = canvas.height / 8;\n                  xPos = canvas.width / 2 - recWidth / 2;\n                  yPos = canvas.height / 2 - recHeight / 2;\n                  img = new Image();\n                  img.src = \"https://www.shareicon.net/data/256x256/2015/12/04/682310_cross_512x512.png\";\n                  ctx.fillStyle = \"gray\";\n                  ctx.fillRect(xPos, yPos, recWidth, recHeight);\n                  ctx.drawImage(img, xPos, yPos, recWidth, recHeight);\n\n                  if (!(total == end)) {\n                    _context.next = 18;\n                    break;\n                  }\n\n                  window.cancelAnimationFrame(intervalId);\n                  that.audioContext.close();\n                  that.setState({\n                    continue: true\n                  });\n                  return _context.abrupt(\"return\");\n\n                case 18:\n                  if (total < end) {\n                    intervalId = window.requestAnimationFrame(generate_noise); //console.log(that.state.contrast_array_1, that.state.responses_1);\n\n                    if (that.state.currentQ == 1 && that.state.change == true) {\n                      console.log(\"changing the q\");\n                      q_1 = QuestUpdate(q_1, [that.state.contrast_array_1[that.state.contrast_array_1.length - 1]], [that.state.responses_1[that.state.responses_1.length - 1]]);\n                      console.log(QuestQuantile(q_1));\n                      that.setState({\n                        change: false\n                      });\n                    }\n\n                    if (that.state.currentQ == 2 && that.state.change == true) {\n                      q_2 = QuestUpdate(q_2, that.state.contrast_array_1[that.state.contrast_array_1.length - 1], that.state.responses_1[that.state.responses_1.length - 1]);\n                      that.setState({\n                        change: false\n                      });\n                    }\n                  }\n\n                case 19:\n                case \"end\":\n                  return _context.stop();\n              }\n            }\n          }, _callee);\n        }));\n        return _generate_noise.apply(this, arguments);\n      }\n\n      generate_noise.call(that);\n    }\n  }, {\n    key: \"keyFunction\",\n    value: function keyFunction(event) {\n      var seconds = new Date().getTime() / 1000;\n\n      if (event.keyCode === 81 && this.state.time_window == true && this.state.currentQ == 1) {\n        // Set setState\n        this.setState({\n          counter: this.state.counter + 1,\n          responses_1: this.state.responses_1.concat([1]),\n          response_time_1: this.state.response_time_1.concat([seconds - this.state.time_window_start]),\n          time_window: false\n        });\n\n        if (this.state.counter == this.state.limit) {\n          this.setState({\n            continue: true\n          });\n        }\n      }\n\n      if (event.keyCode === 81 && this.state.time_window == true && this.state.currentQ == 2) {\n        // Set setState\n        this.setState({\n          counter2: this.state.counter2 + 1,\n          responses_2: this.state.responses_2.concat([1]),\n          response_time_2: this.state.response_time_2.concat([seconds - this.state.time_window_start]),\n          time_window: false\n        });\n\n        if (this.state.counter == this.state.limit) {\n          this.setState({\n            continue: true\n          });\n        }\n      }\n\n      if (event.keyCode === 69 && this.state.time_window == true && this.state.currentQ == 1) {\n        this.setState({\n          counter: this.state.counter + 1,\n          responses_1: this.state.responses_1.concat([0]),\n          response_time_1: this.state.response_time_1.concat([seconds - this.state.time_window_start]),\n          time_window: false\n        });\n\n        if (this.state.counter == this.state.limit) {\n          this.setState({\n            continue: true\n          });\n        }\n      }\n\n      if (event.keyCode === 69 && this.state.time_window == true && this.state.currentQ == 2) {\n        this.setState({\n          counter: this.state.counter2 + 1,\n          responses_2: this.state.responses_2.concat([0]),\n          response_time_2: this.state.response_time_2.concat([seconds - this.state.time_window_start]),\n          time_window: false\n        });\n\n        if (this.state.counter == this.state.limit) {\n          this.setState({\n            continue: true\n          });\n        }\n      }\n\n      if ((event.keyCode === 49 || event.keyCode === 50 || event.keyCode === 51 || event.keyCode === 52 || event.keyCode === 53) && this.state.time_window_rating == true) {\n        if (this.state.currentQ == 1) {\n          this.setState({\n            ratings_1: this.state.ratings_1.concat([event.keyCode - 48]),\n            time_window_rating: false\n          });\n        } else {\n          this.setState({\n            ratings_2: this.state.ratings_2.concat([event.keyCode - 48]),\n            time_window_rating: false\n          });\n        }\n      }\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      document.addEventListener(\"keydown\", this.keyFunction, false);\n\n      if (this.state.continue == false) {\n        this.create_noise(this.audioContext);\n      }\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      document.removeEventListener(\"keydown\", this.keyFunction, false);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      if (this.state.continue == true) {\n        alert(\"Trial completed\");\n        return React.createElement(Redirect, {\n          to: \"/Complete\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 403\n          },\n          __self: this\n        });\n      }\n\n      return React.createElement(\"div\", {\n        className: \"Trial\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 407\n        },\n        __self: this\n      }, React.createElement(\"input\", {\n        type: \"hidden\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 408\n        },\n        __self: this\n      }), React.createElement(\"header\", {\n        className: \"Trial-header\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 409\n        },\n        __self: this\n      }, React.createElement(\"canvas\", {\n        id: \"c\",\n        width: \"256\",\n        height: \"256\",\n        style: {\n          zIndex: \"0\",\n          position: \"fixed\",\n          left: \"25%\",\n          width: '50%',\n          height: 'auto'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 410\n        },\n        __self: this\n      }), React.createElement(\"canvas\", {\n        id: \"c2\",\n        width: \"256\",\n        height: \"256\",\n        style: {\n          zIndex: \"1\",\n          position: \"fixed\",\n          left: \"25%\",\n          width: '50%',\n          height: 'auto'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 412\n        },\n        __self: this\n      })));\n    }\n  }]);\n\n  return TrialQ;\n}(Component);\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    data: state.data\n  };\n};\n\nvar mapDispatchToProps = function mapDispatchToProps(dispatch) {\n  return {\n    add_response_1: function add_response_1(element) {\n      return dispatch(_add_response_(element));\n    },\n    add_response_time_1: function add_response_time_1(element) {\n      return dispatch(_add_response_time_(element));\n    },\n    add_contrast_1: function add_contrast_1(element) {\n      return dispatch(_add_contrast_(element));\n    },\n    add_array: function add_array(arr) {\n      return dispatch(_add_array(arr));\n    }\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(TrialQ);\n\nfunction beep(amp, freq, ms, audioContext) {\n  //amp:0..100, freq in Hz, ms\n  if (!audioContext) return;\n  var osc = audioContext.createOscillator();\n  var gain = audioContext.createGain();\n  osc.connect(gain);\n  osc.value = freq;\n  gain.connect(audioContext.destination);\n  gain.gain.value = amp / 100;\n  osc.start(audioContext.currentTime);\n  osc.stop(audioContext.currentTime + ms / 1000);\n} //array shuffling function, used to randomize order of presentation for different blocks\n\n\nfunction shuffle(array) {\n  var i = 0;\n  var j = 0;\n  var temp = null;\n\n  for (i = array.length - 1; i > 0; i -= 1) {\n    j = Math.floor(Math.random() * (i + 1));\n    temp = array[i];\n    array[i] = array[j];\n    array[j] = temp;\n  }\n}","map":{"version":3,"sources":["C:\\Users\\Alika\\Desktop\\VCH_APP\\src\\containers\\TrialQ.js"],"names":["React","Component","Redirect","createStim","createGabor","QuestCreate","QuestRecompute","QuestTrials","QuestUpdate","QuestStimulate","QuestMean","QuestMode","QuestSd","QuestP","QuestPdf","QuestQuantile","PAL_Gumbel","connect","add_array","add_response_1","add_response_time_1","add_contrast_1","TrialQ","props","keyFunction","bind","create_noise","state","continue","counter","counter2","change","responses_1","contrast_array_1","response_time_1","ratings_1","responses_2","contrast_array_2","response_time_2","ratings_2","time_window","time_window_start","time_window_rating","limit","rating_window","currentQ","canvasRef","createRef","audioContext","AudioContext","callback","end","index1","index2","total","tt1","length","contrast_block","SimplexNoise","require","simplex","canvas","document","getElementById","ctx","getContext","imgdata","getImageData","width","height","data","t","tGuess","tGuessSd","pThreshold","beta","delta","gamma","grain","dim","range","q_1","q_2","stim","stimulus_blank","stimulus","jitter","Math","floor","random","start_time","contrast","intervalId","undefined","that","seconds","generate_noise","console","log","setState","Date","getTime","beep","x","y","img","Image","src","r","noise3D","alpha","concat","slice","putImageData","recWidth","recHeight","xPos","yPos","fillStyle","fillRect","drawImage","window","cancelAnimationFrame","close","requestAnimationFrame","call","event","keyCode","addEventListener","removeEventListener","alert","zIndex","position","left","mapStateToProps","mapDispatchToProps","dispatch","element","arr","amp","freq","ms","osc","createOscillator","gain","createGain","value","destination","start","currentTime","stop","shuffle","array","i","j","temp"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport './Trial.css';\r\nimport { Redirect } from \"react-router-dom\";\r\nimport { createStim, createGabor } from \"../Stim.js\"\r\nimport { QuestCreate, QuestRecompute, QuestTrials, QuestUpdate, QuestStimulate, QuestMean, QuestMode, QuestSd, QuestP, QuestPdf, QuestQuantile, PAL_Gumbel } from \"../Quest.js\"\r\n\r\nimport { connect } from 'react-redux'\r\nimport { add_array, add_response_1, add_response_time_1, add_contrast_1 } from '../actions/data'\r\n\r\nclass TrialQ extends Component {\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.keyFunction = this.keyFunction.bind(this);\r\n    this.create_noise = this.create_noise.bind(this);\r\n    this.state = {\r\n      continue: false,\r\n      counter: 0,\r\n      counter2: 0,\r\n      change: false,\r\n\r\n      responses_1: [],\r\n      contrast_array_1: [],\r\n      response_time_1: [],\r\n      ratings_1: [],\r\n\r\n      responses_2: [],\r\n      contrast_array_2: [],\r\n      response_time_2: [],\r\n      ratings_2: [],\r\n\r\n      time_window: false,\r\n      time_window_start: 0,\r\n      time_window_rating: false,\r\n      limit: 100,\r\n\r\n      rating_window: false,\r\n\r\n      currentQ: 1, //1 for contrast 1 and 2 for contrast 2\r\n\r\n    }\r\n    this.canvasRef = React.createRef();\r\n    this.audioContext = new AudioContext();\r\n  }\r\n\r\n  create_noise(audioContext, callback) {\r\n\r\n    var end = 80;\r\n    // var contrast_block = tt1;\r\n    var index1 = 0;\r\n    var index2 = 0;\r\n    var total = 0;\r\n\r\n    //train_test arrays\r\n    var tt1 = [0, .5, 1, 0, .5, 1, 0, .5, 1, 0, .5, 1];\r\n    var end = tt1.length;\r\n    var contrast_block = tt1;\r\n\r\n    var SimplexNoise = require('simplex-noise');\r\n\r\n    var simplex = new SimplexNoise(),\r\n      canvas = document.getElementById('c'),\r\n      ctx = canvas.getContext('2d'),\r\n      imgdata = ctx.getImageData(0, 0, canvas.width, canvas.height),\r\n      data = imgdata.data,\r\n      t = 0;\r\n\r\n    //initializing QUEST\r\n    var tGuess = 0.5,\r\n      tGuessSd = 0.1,\r\n      pThreshold = 0.75,\r\n      beta = 3.5,\r\n      delta = 0.01,\r\n      gamma = 0.01,\r\n      grain = 0.001,\r\n      dim = 1000,\r\n      range = 20;\r\n    var q_1 = QuestCreate(tGuess, tGuessSd, pThreshold, beta, delta, gamma, grain, range);\r\n    var q_2 = QuestCreate(tGuess, tGuessSd, pThreshold, beta, delta, gamma, grain, range);\r\n\r\n    var stim = createStim();\r\n    var stimulus_blank = createGabor(stim, 0);\r\n\r\n    var stimulus;\r\n    var jitter = Math.floor(Math.random() * 20); //jitter tone presentation 0-500ms per trial\r\n    var start_time = 100;\r\n    var contrast = 0;\r\n    var intervalId = undefined;\r\n\r\n    var that = this;\r\n    var seconds = 0;\r\n\r\n    async function generate_noise() {\r\n\r\n      if (t == start_time + jitter) {\r\n\r\n        index1 = that.state.counter;\r\n        index2 = that.state.counter2;\r\n\r\n        total = index1 + index2;\r\n\r\n        console.log(QuestQuantile(q_1), QuestQuantile(q_2)); \r\n\r\n        // determining which staircase to use\r\n        if (index1 == index2) {\r\n          that.setState({             //current staircase is 1\r\n            currentQ: 1,\r\n          });\r\n        }\r\n\r\n        if (index1 != index2) {\r\n          index2++;\r\n          that.setState({             //current staircase is 2\r\n            currentQ: 2,\r\n          });\r\n        }\r\n\r\n        if (that.state.currentQ == 1) {\r\n          if (index1 = 0) {\r\n            contrast = tGuess + .3;\r\n          }\r\n          else {\r\n            contrast = QuestQuantile(q_1);\r\n          }\r\n        }\r\n        if (that.state.currentQ == 2) {\r\n          if (index2 = 0) {\r\n            contrast = tGuess - 0.3;\r\n          }\r\n          else {\r\n            contrast = QuestQuantile(q_2);\r\n          }\r\n        }\r\n\r\n        console.log(contrast);\r\n\r\n        var seconds = new Date().getTime() / 1000;\r\n\r\n        console.log(\"time on \", seconds);\r\n\r\n        that.setState({\r\n          time_window: true,\r\n          time_window_rating: true,\r\n          time_window_start: seconds,\r\n        });\r\n\r\n        console.log(\"for 1\", that.state.responses_1, that.state.ratings_1, that.state.response_time_1, that.state.contrast_array_1);\r\n        console.log(\"for 2\", that.state.responses_2, that.state.ratings_2, that.state.response_time_2, that.state.contrast_array_2);\r\n\r\n        stimulus = createGabor(stim, contrast);\r\n        beep(50, 830, 300, audioContext); //beep for arg3 miliseconds\r\n      }\r\n\r\n      for (var x = 0; x < 256; x++) {\r\n        for (var y = 0; y < 256; y++) {\r\n          if( that.state.rating_window == true ){\r\n            var img = new Image();\r\n            img.src = \"data:image/jpeg;base64,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\";\r\n          }\r\n          if (t == start_time + jitter || t == start_time + jitter + 1 || t == start_time + jitter + 2 || t == start_time + jitter + 3 || t == start_time + jitter + 4\r\n            || t == start_time + jitter + 5 || t == start_time + jitter + 6 || t == start_time + jitter + 7 || t == start_time + jitter + 8 || t == start_time + jitter + 9\r\n            || t == start_time + jitter + 10 || t == start_time + jitter + 11 || t == start_time + jitter + 12 || t == start_time + jitter + 13 || t == start_time + jitter + 14\r\n            || t == start_time + jitter + 15 || t == start_time + jitter + 16 || t == start_time + jitter + 17 || t == start_time + jitter + 18 || t == start_time + jitter + 19\r\n            || t == start_time + jitter + 20 || t == start_time + jitter + 21 || t == start_time + jitter + 22 || t == start_time + jitter + 23 || t == start_time + jitter + 24\r\n            || t == start_time + jitter + 25 || t == start_time + jitter + 26 || t == start_time + jitter + 27 || t == start_time + jitter + 28 || t == start_time + jitter + 29\r\n            || t == start_time + jitter + 30) {\r\n            if (t == start_time + jitter + 30) {\r\n              t = 0;\r\n              //during beep show signal, then reset timer to 0\r\n            }\r\n\r\n            var r = simplex.noise3D(x / 8, y / 8, t / 8) * 0.4 + 0.35;\r\n            data[(x + y * 256) * 4 + 0] = stim.alpha * stimulus[(x + y * 256) * 4 + 0] + (1 - stim.alpha) * r * 250;\r\n            data[(x + y * 256) * 4 + 1] = stim.alpha * stimulus[(x + y * 256) * 4 + 1] + (1 - stim.alpha) * r * 250;\r\n            data[(x + y * 256) * 4 + 2] = stim.alpha * stimulus[(x + y * 256) * 4 + 2] + (1 - stim.alpha) * r * 250;\r\n            data[(x + y * 256) * 4 + 3] = 255;\r\n          }\r\n\r\n          else {\r\n\r\n            seconds = new Date().getTime() / 1000\r\n\r\n            if (that.state.time_window_start + 2 == seconds) {\r\n              that.setState({\r\n                time_window: false,\r\n                time_window_rating: false,\r\n              });\r\n\r\n              if (that.state.currentQ == 1) {\r\n\r\n                if (that.state.contrast_array_1.length < that.state.responses_1.length) {\r\n                  that.setState({ contrast_array_1: that.state.contrast_array_1.concat([contrast]) });\r\n                  that.setState({ change: true });\r\n                }\r\n\r\n                if (that.state.responses_1.length != that.state.ratings_1.length) {\r\n\r\n                  if (that.state.responses_1.length > that.state.ratings_1.length) {\r\n\r\n                    console.log(\"response and response time discarded\", that.state.responses_1, that.state.response_time_1, that.state.ratings_1, that.state.contrast_array_1);\r\n\r\n                    that.setState({\r\n                      responses_1: that.state.responses_1.slice(0, that.state.ratings_1.length),\r\n                      response_time_1: that.state.response_time_1.slice(0, that.state.ratings_1.length),\r\n                      counter: that.state.counter - 1,\r\n                      contrast_array_1: that.state.contrast_array_1.slice(0, that.state.ratings_1.length)\r\n                    });\r\n                  }\r\n\r\n                  else {\r\n                    console.log(\"rating discarded\", that.state.responses_1, that.state.ratings_1, that.state.contrast_array_1);\r\n\r\n                    that.setState({\r\n                      ratings_1: that.state.ratings_1.slice(0, that.state.responses_1.length),\r\n                    });\r\n                  }\r\n                }\r\n              }\r\n\r\n              if (that.state.currentQ == 2) {\r\n\r\n                if (that.state.contrast_array_2.length < that.state.responses_2.length) {\r\n                  that.setState({ contrast_array_2: that.state.contrast_array_2.concat([contrast]) });\r\n                  that.setState({ change: true });\r\n                }\r\n\r\n                if (that.state.responses_2.length != that.state.ratings_2.length) {\r\n\r\n                  if (that.state.responses_2.length > that.state.ratings_2.length) {\r\n\r\n                    console.log(\"response and response time discarded\", that.state.responses_2, that.state.response_time_2, that.state.ratings_2, that.state.contrast_array_2);\r\n\r\n                    that.setState({\r\n                      responses_2: that.state.responses_2.slice(0, that.state.ratings_2.length),\r\n                      response_time_2: that.state.response_time_2.slice(0, that.state.ratings_2.length),\r\n                      counter: that.state.counter - 1,\r\n                      contrast_array_2: that.state.contrast_array_2.slice(0, that.state.ratings_2.length)\r\n                    });\r\n                  }\r\n\r\n                  else {\r\n                    console.log(\"rating discarded\", that.state.responses_2, that.state.ratings_2, that.state.contrast_array_2);\r\n\r\n                    that.setState({\r\n                      ratings_2: that.state.ratings_2.slice(0, that.state.responses_2.length),\r\n                    });\r\n                  }\r\n                }\r\n              }\r\n              console.log(\"time off \", seconds);\r\n            }\r\n\r\n\r\n            var r = simplex.noise3D(x / 8, y / 8, t / 8) * 0.4 + 0.35;\r\n            data[(x + y * 256) * 4 + 0] = stim.alpha * stimulus_blank[(x + y * 256) * 4 + 0] + (1 - stim.alpha) * r * 250;\r\n            data[(x + y * 256) * 4 + 1] = stim.alpha * stimulus_blank[(x + y * 256) * 4 + 1] + (1 - stim.alpha) * r * 250;\r\n            data[(x + y * 256) * 4 + 2] = stim.alpha * stimulus_blank[(x + y * 256) * 4 + 2] + (1 - stim.alpha) * r * 250;\r\n            data[(x + y * 256) * 4 + 3] = 255;\r\n            //if there is no beep, show blank signal\r\n          }\r\n        }\r\n      }\r\n\r\n      t++;\r\n      ctx.putImageData(imgdata, 0, 0);\r\n\r\n      var recWidth = canvas.width / 8;\r\n      var recHeight = canvas.height / 8;\r\n\r\n      var xPos = (canvas.width / 2) - (recWidth / 2);\r\n\r\n      var yPos = (canvas.height / 2) - (recHeight / 2);\r\n      var img = new Image();\r\n      img.src = \"https://www.shareicon.net/data/256x256/2015/12/04/682310_cross_512x512.png\";\r\n      ctx.fillStyle = \"gray\";\r\n\r\n      ctx.fillRect(xPos, yPos, recWidth, recHeight);\r\n      ctx.drawImage(img, xPos, yPos, recWidth, recHeight);\r\n\r\n      if (total == end) {\r\n        window.cancelAnimationFrame(intervalId);\r\n        that.audioContext.close();\r\n        that.setState({ continue: true });\r\n        return;\r\n      }\r\n\r\n      if (total < end) {\r\n        intervalId = window.requestAnimationFrame(generate_noise);\r\n\r\n        //console.log(that.state.contrast_array_1, that.state.responses_1);\r\n\r\n        if (that.state.currentQ == 1 && that.state.change == true) {\r\n          console.log(\"changing the q\")\r\n          q_1 = QuestUpdate(q_1, [that.state.contrast_array_1[that.state.contrast_array_1.length - 1]], [that.state.responses_1[that.state.responses_1.length - 1]]);\r\n          console.log(QuestQuantile(q_1));\r\n          that.setState({ change: false });\r\n        }\r\n\r\n        if (that.state.currentQ == 2 && that.state.change == true) {\r\n          q_2 = QuestUpdate(q_2, that.state.contrast_array_1[that.state.contrast_array_1.length - 1], that.state.responses_1[that.state.responses_1.length - 1]);\r\n          that.setState({ change: false });\r\n        }\r\n      }\r\n\r\n    }\r\n\r\n    generate_noise.call(that);\r\n\r\n  }\r\n\r\n  keyFunction(event) {\r\n    var seconds = new Date().getTime() / 1000\r\n\r\n    if (event.keyCode === 81 && this.state.time_window == true && this.state.currentQ == 1) {\r\n\r\n      // Set setState\r\n      this.setState({\r\n        counter: this.state.counter + 1,\r\n        responses_1: this.state.responses_1.concat([1]),\r\n        response_time_1: this.state.response_time_1.concat([seconds - this.state.time_window_start]),\r\n        time_window: false,\r\n      });\r\n\r\n      if (this.state.counter == this.state.limit) {\r\n        this.setState({ continue: true });\r\n      }\r\n\r\n    }\r\n\r\n    if (event.keyCode === 81 && this.state.time_window == true && this.state.currentQ == 2) {\r\n\r\n      // Set setState\r\n      this.setState({\r\n        counter2: this.state.counter2 + 1,\r\n        responses_2: this.state.responses_2.concat([1]),\r\n        response_time_2: this.state.response_time_2.concat([seconds - this.state.time_window_start]),\r\n        time_window: false,\r\n      });\r\n\r\n      if (this.state.counter == this.state.limit) {\r\n        this.setState({ continue: true });\r\n      }\r\n\r\n    }\r\n\r\n    if (event.keyCode === 69 && this.state.time_window == true && this.state.currentQ == 1) {\r\n      this.setState({\r\n        counter: this.state.counter + 1,\r\n        responses_1: this.state.responses_1.concat([0]),\r\n        response_time_1: this.state.response_time_1.concat([seconds - this.state.time_window_start]),\r\n        time_window: false,\r\n      });\r\n\r\n      if (this.state.counter == this.state.limit) {\r\n        this.setState({ continue: true });\r\n      }\r\n    }\r\n\r\n    if (event.keyCode === 69 && this.state.time_window == true && this.state.currentQ == 2) {\r\n      this.setState({\r\n        counter: this.state.counter2 + 1,\r\n        responses_2: this.state.responses_2.concat([0]),\r\n        response_time_2: this.state.response_time_2.concat([seconds - this.state.time_window_start]),\r\n        time_window: false,\r\n      });\r\n\r\n      if (this.state.counter == this.state.limit) {\r\n        this.setState({ continue: true });\r\n      }\r\n    }\r\n\r\n\r\n    if ((event.keyCode === 49 || event.keyCode === 50 || event.keyCode === 51 || event.keyCode === 52 || event.keyCode === 53) && this.state.time_window_rating == true) {\r\n      if(this.state.currentQ == 1){\r\n        this.setState({\r\n          ratings_1: this.state.ratings_1.concat([event.keyCode - 48]),\r\n          time_window_rating: false,\r\n        });\r\n      }\r\n      else{\r\n        this.setState({\r\n          ratings_2: this.state.ratings_2.concat([event.keyCode - 48]),\r\n          time_window_rating: false,\r\n        });\r\n      }\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    document.addEventListener(\"keydown\", this.keyFunction, false);\r\n    if (this.state.continue == false) {\r\n      this.create_noise(this.audioContext);\r\n    }\r\n  }\r\n  componentWillUnmount() {\r\n    document.removeEventListener(\"keydown\", this.keyFunction, false);\r\n  }\r\n\r\n  render() {\r\n\r\n    if (this.state.continue == true) {\r\n      alert(\"Trial completed\")\r\n      return <Redirect to=\"/Complete\" />\r\n    }\r\n\r\n    return (\r\n      <div className=\"Trial\">\r\n        <input type=\"hidden\" />\r\n        <header className=\"Trial-header\">\r\n          <canvas id=\"c\" width=\"256\" height=\"256\"\r\n            style={{ zIndex: \"0\", position: \"fixed\", left: \"25%\", width: '50%', height: 'auto' }}></canvas>\r\n          <canvas id=\"c2\" width=\"256\" height=\"256\"\r\n            style={{ zIndex: \"1\", position: \"fixed\", left: \"25%\", width: '50%', height: 'auto' }}></canvas>\r\n        </header>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = state => ({\r\n  data: state.data,\r\n})\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  add_response_1: (element) => dispatch(add_response_1(element)),\r\n  add_response_time_1: (element) => dispatch(add_response_time_1(element)),\r\n  add_contrast_1: (element) => dispatch(add_contrast_1(element)),\r\n  add_array: (arr) => dispatch(add_array(arr)),\r\n})\r\n\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(TrialQ);\r\n\r\n\r\nfunction beep(amp, freq, ms, audioContext) {//amp:0..100, freq in Hz, ms\r\n  if (!audioContext) return;\r\n  var osc = audioContext.createOscillator();\r\n  var gain = audioContext.createGain();\r\n  osc.connect(gain);\r\n  osc.value = freq;\r\n  gain.connect(audioContext.destination);\r\n  gain.gain.value = amp / 100;\r\n  osc.start(audioContext.currentTime);\r\n  osc.stop(audioContext.currentTime + ms / 1000);\r\n}\r\n\r\n//array shuffling function, used to randomize order of presentation for different blocks\r\nfunction shuffle(array) {\r\n  var i = 0\r\n  var j = 0\r\n  var temp = null\r\n\r\n  for (i = array.length - 1; i > 0; i -= 1) {\r\n    j = Math.floor(Math.random() * (i + 1))\r\n    temp = array[i]\r\n    array[i] = array[j]\r\n    array[j] = temp\r\n  }\r\n}\r\n\r\n"]},"metadata":{},"sourceType":"module"}