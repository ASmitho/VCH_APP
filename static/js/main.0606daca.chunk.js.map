{"version":3,"sources":["media/psych_logo.jpg","Quest.js","VisualQuest.js","actions/data.js","containers/Welcome.js","containers/Instructions.js","Stim.js","containers/Trial.js","containers/NotFound.js","containers/Complete.js","containers/TrialQ.js","Routes.js","App.js","reducers/data.js","reducers/index.js","configureStore.js","index.js"],"names":["module","exports","__webpack_require__","p","isEmpty","arrayArg","undefined","length","QuestCreate","tGuess","tGuessSd","pThreshold","beta","delta","gamma","grain","range","plotIt","nargin","arguments","dim","Error","Math","ceil","isFinite","isNaN","newQ","updatePdf","warnPdf","normalizePdf","xThreshold","i","x","x2","p2","s2","intensity","response","trialCount","quantileOrder","makeQ","QuestRecompute","q","math","require","console","log","push","map","tempA","tempB","pow","pdf","exp","sumPDF","sumVector","i2","eval","min","max","apply","linear","tempC","slice","array1","reverse","array2","arrayZero","Array","fill","k","pL","pH","pE","Number","EPSILON","j","inten","ii","round","h2","QuestUpdate","low","high","alert","QuestMean","multiplyVector","QuestSd","xSquared","Squared2","sqrt","QuestQuantile","arr","new_array","reduce","a","b","cumsum","tempP","unshift","index","findZero","diff","temp1","subarrayIndex","temp2","PAL_Gumbel","alpha","lambda","varargin","isArray","y","t","c","divide","add","indices","e","v","gumbel_intensities","q1","q2","tmean","returnStruct","intensities","parameters","ch_QuestBetaAnalysis","mean_alpha","estimate_beta","mean","fzero","fn25","toString","solution","parseFloat","qq","t2","QuestPdf","beta2","modeP","sd","sum","betaEstimate","iBetaSd","add_response_1","item","type","payload","add_response_time_1","add_contrast_1","add_array","Welcome","props","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","keyFunction","bind","assertThisInitialized","state","continue","event","keyCode","setState","document","addEventListener","removeEventListener","t1","sd1","sd2","process_data","react_default","createElement","react_router","to","className","href","title","target","rel","src","logo","alt","Component","connect","data","dispatch","elem","Instructions","createStim","stim","background","angle","floor","random","imsize","initcontrast","threshold","phases","phase","ppd","frequency","createGabor","contrast","xs","ys","patch","cos","PI","sin","Trial","create_noise","counter","responses_1","contrast_array_1","response_time_1","ratings_1","responses_2","contrast_array_2","response_time_2","ratings_2","time_window","time_window_start","time_window_rating","limit","contrast_flag","canvasRef","React","createRef","audioContext","AudioContext","callback","stimulus","tt1","end","contrast_block","simplex","canvas","getElementById","ctx","getContext","imgdata","getImageData","width","height","stimulus_blank","jitter","start_time","intervalId","that","generate_noise","_generate_noise","asyncToGenerator","regenerator_default","mark","_callee","seconds","r","recWidth","recHeight","xPos","yPos","img","g","wrap","_context","prev","next","Date","getTime","beep","noise3D","concat","putImageData","Image","fillStyle","fillRect","drawImage","window","cancelAnimationFrame","close","abrupt","requestAnimationFrame","stop","id","style","zIndex","position","left","element","amp","freq","ms","osc","createOscillator","gain","createGain","value","destination","start","currentTime","containers_NotFound","Complete","d","idx","key","listStyleType","contrast_1","TrialQ","counter2","change","rating_window","currentQ","index1","index2","total","q_1","q_2","vis_quest","_vis_quest","Routes","path","exact","component","NotFound","App","initialState","contrast_2","test","rtReducer","action","objectSpread","toConsumableArray","rootReducer","history","combineReducers","router","connectRouter","createBrowserHistory","store","preloadedState","composeEnhancer","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","compose","createStore","createRootReducer","applyMiddleware","routerMiddleware","configureStore","ReactDOM","render","es","react_router_dom","basename","process","src_App_0"],"mappings":"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","file":"static/js/main.0606daca.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/psych_logo.6956dbda.jpg\";","import { isArray } from 'util';\r\n\r\nexport function isEmpty( arrayArg ){\r\n    if (arrayArg === undefined || arrayArg.length == 0) {\r\n        return true;\r\n    }\r\n    else{\r\n        return false;\r\n    }\r\n}\r\n\r\nexport function makeQ( tGuess, tGuessSd, pThreshold, beta, delta, gamma, grain, dim ){\r\n    var newQ = {\r\n        updatePdf: 1, //boolean: 0 for no, 1 for yes\r\n        warnPdf: 1,  //boolean\r\n        normalizePdf: 1,  //boolean. This adds a few ms per call to QuestUpdate, but otherwise the pdf will underflow after about 1000 trials.\r\n        tGuess: tGuess,\r\n        tGuessSd: tGuessSd,\r\n        pThreshold: pThreshold,\r\n        xThreshold: 0, \r\n        beta: beta,\r\n        delta: delta,\r\n        gamma: gamma,\r\n        grain: grain,\r\n        dim: dim,\r\n        i: [],\r\n        x: [], \r\n        x2: [],\r\n        p2: [],\r\n        s2: [], //have to make an array of arrays due to lack of multidimensional array support\r\n        intensity: [], \r\n        response: [],\r\n        trialCount: 0,\r\n        quantileOrder: 0, \r\n    };\r\n\r\n    return newQ; \r\n}\r\n\r\n\r\nexport function QuestCreate( tGuess, tGuessSd, pThreshold, beta, delta, gamma, grain, range, plotIt ){\r\n\r\n    let nargin = arguments.length;\r\n    let dim = 0;\r\n    \r\n    if(nargin > 9 || nargin < 6){\r\n        throw new Error(\"Incorrect number of arguments\");\r\n    }\r\n    if( nargin < 7 || isEmpty( grain ) ){\r\n        grain = 0.01000;\r\n    }\r\n\r\n    if( true ){\r\n        if( nargin < 8 || isEmpty( range ) ){\r\n            dim = 500;\r\n        }\r\n        else{\r\n            if( range <= 0 ){\r\n                throw new Error(\"Range must be greater than 0\");\r\n            }\r\n            dim = range / grain;\r\n            dim = 2 * Math.ceil( dim / 2 );\r\n        }\r\n    }\r\n\r\n    if( nargin < 9 || isEmpty( plotIt )) {\r\n        plotIt = 0;\r\n    }\r\n\r\n    // Double check here if there are number errors \r\n    if( !(isFinite( tGuess )) || (isNaN( tGuess )) ){\r\n        throw new Error( \"tGuess must be real and finite\" );\r\n    }\r\n    \r\n    var newQ = makeQ( tGuess, tGuessSd, pThreshold, beta, delta, gamma, grain, dim );\r\n    newQ = QuestRecompute( newQ, plotIt );\r\n\r\n    return newQ;\r\n}\r\n\r\nexport function QuestRecompute( q, plotIt ) {\r\n\r\n    const math = require('mathjs');\r\n\r\n    if( arguments.length < 1 ){\r\n        throw new Error(\"Usage: QuestRecompute( q, plotIt = 0 )\");\r\n    }\r\n\r\n    //if the struct contains more than one struct as an array then you must set normalizePdf of each to 0. \r\n\r\n    if( !q.updatePdf ){\r\n        return\r\n    }\r\n\r\n    if( q.gamma > q.pThreshold ){\r\n        console.log(\"Reducing gamma from %.2f to 0.5\");\r\n        q.gamma = 0.5; \r\n    }\r\n\r\n    if( arguments.length < 2 || isEmpty( plotIt ) ){\r\n        plotIt = 0; \r\n    }\r\n\r\n    q.i = [];\r\n    q.x = []; \r\n    q.x2 = [];\r\n    q.p2 = [];\r\n    q.s2 = []; //have to make an array of arrays due to lack of multidimensional array support\r\n\r\n\r\n    for(var i = -q.dim/2; i <= q.dim/2; i++){\r\n        q.i.push( i );  \r\n    };\r\n\r\n    q.x = q.i.map( function( x ) { return x * q.grain; });\r\n\r\n    let tempA = q.x.map( function( x ) { return x / q.tGuessSd; });\r\n    let tempB = tempA.map( function ( x ) { return Math.pow( x, 2 ); });\r\n\r\n    q.pdf = (tempB.map( function ( x ) { return x * -0.5; })).map( function ( x ) { return Math.exp( x ); });;\r\n    let sumPDF = sumVector(q.pdf); \r\n    q.pdf = q.pdf.map( function( x ) { return x / sumPDF; });\r\n\r\n\r\n    let i2 = []; \r\n    for( i = -q.dim; i <= q.dim; i++){\r\n        i2.push(i);  \r\n    }\r\n    q.x2 = i2.map( function( x ) {return (math.eval(x + \"*\" + q.grain));}); \r\n\r\n    tempA = q.x2.map( function( x ) { return (math.eval(x + \"*\" + q.beta)); }); \r\n\r\n    q.p2 = tempA.map( function( x ) { \r\n        // results are slightly off from the ten thousands place increasing to the hundreths place by .01 at times;\r\n        return ( math.eval( q.delta + \"*\" + q.gamma + \"+ ( 1 -\" + q.delta + \" ) * ( 1 - ( 1-\" + q.gamma +\") *\" + \"e^(-10 ^ \" + x + \"))\"));\r\n    });  \r\n\r\n    if( plotIt > 0 ){\r\n        //Plot the data via package *******************************\r\n    }\r\n\r\n    if( Math.min(q.p2[0], q.p2[q.p2.length - 1]) > q.pThreshold || Math.max(q.p2[0], q.p2[q.p2.length - 1]) < q.pThreshold){\r\n        throw new Error( 'psychometric function range [' + Math.min.apply( null, q.p2 ) + \" \" +  Math.max.apply( null, q.p2 ) + ' ] omits ' + q.pThreshold + ' threshold');\r\n    }\r\n\r\n    var linear = require('everpolate').linear;\r\n    q.xThreshold= linear( q.pThreshold , q.p2, q.x2);\r\n    \r\n    for(var i = 0; i < q.p2.length; i++){\r\n        if(!isFinite(q.p2[i])){\r\n            throw new Error( 'psychometric function p2 is not finite' + i);\r\n        }\r\n    }\r\n\r\n    q.p2 = q.x2.map( function ( x ){\r\n        return( math.eval( q.delta + \"*\" + q.gamma + \"+ ( 1 -\" + q.delta + \" ) * ( 1 - ( 1-\" + q.gamma +\") *\" + \"e^(-10 ^ (\" + q.beta + \"* (\" + x + \"+\" + q.xThreshold + \"))))\")); \r\n    } );\r\n\r\n\r\n    let tempC = q.p2.slice(); \r\n    tempC = tempC.reverse(); \r\n    let array1 = tempC.map( function( x ) { return 1 - x; }); \r\n    let array2 = tempC; \r\n\r\n    q.s2[0] = array1; \r\n    q.s2[1] = array2; \r\n\r\n    if( q.intensity.length == 0 || q.response.length  == 0 ){\r\n        let arrayZero = new Array(10000).fill(0); \r\n        q.trialCount = 0;\r\n        q.intensity = arrayZero;\r\n        q.response = arrayZero;\r\n    }   \r\n\r\n\r\n    for( var k = 0; k < q.s2.length; k++){\r\n        for( i = 0; i < q.s2[k].length; i++){\r\n            if(!isFinite(q.s2[k][i])){\r\n                throw new Error( 'psychometric function s2 is not finite' + i);\r\n            }\r\n        }\r\n    }     \r\n    \r\n    let pL = q.p2[0];\r\n    let pH = q.p2[q.p2.length - 1];\r\n    let pE = pH * Math.log(pH + Number.EPSILON) - pL * Math.log( pL+Number.EPSILON ) + ( 1 - pH + Number.EPSILON) * Math.log( 1 - pH + Number.EPSILON ) - ( 1 - pL + Number.EPSILON) * Math.log( 1 - pL + Number.EPSILON);\r\n    pE = 1 / (1 + Math.exp( pE / ( pL - pH)));\r\n    q.quantileOrder= ( pE - pL ) / ( pH - pL);\r\n\r\n    for(var j = 0; j < q.pdf.length; j++){\r\n        if(!isFinite(q.pdf[j])){\r\n            throw new Error( 'prior pdf is not finite');\r\n        }\r\n    }\r\n\r\n    for(k = 0; k < q.trialCount; k++){\r\n        var inten = Math.max( -1e10, Math.min( 1e10 , q.intensity[k])); \r\n        var ii = q.i.map( function( x ) { return q.pdf.length + x - Math.round(( inten - q.tGuess ) / q.grain ); } );\r\n        \r\n        if( ii[ 0 ] < 1){\r\n            ii = ii.map( function( x ) { return (x + 1 - ii[ 0 ]) ; }); \r\n        }\r\n\r\n        if( ii[ii.length - 1] > q.s2[0].length ){\r\n            ii = ii.map( function( x ) { return( x + q.s2.length - ii[ii.length - 1] ); } ); \r\n        }\r\n\r\n        let h2 = ii.map( function( x ) { return( q.s2[q.response[k]][x] ); });\r\n\r\n        for(i = 0; i < h2.length; i++){\r\n            q.pdf[i] = q.pdf[i] * h2[i];\r\n        }\r\n\r\n\t\tif( q.normalizePdf && k % 100 == 0){\r\n            let sumPDF = sumVector(q.pdf); \r\n            q.pdf = q.pdf.map( function( x ) { return x / sumPDF; }); //avoid underflow; keep the pdf normalized // 3 ms\r\n        }\r\n    }\r\n    \r\n\r\n    if( q.normalizePdf ){\r\n        let sumPDF = sumVector( q.pdf ); \r\n        q.pdf = q.pdf.map( function( x ) { return x / sumPDF; }); //avoid underflow; keep the pdf normalized // 3 ms\r\n    }\r\n\r\n    for(i = 0; i < q.pdf.length; i++){\r\n        if(!isFinite(q.pdf[i])){\r\n            throw new Error( 'pdf is not finite');\r\n        }\r\n    }\r\n\r\n    return q; \r\n}\r\n\r\nexport function QuestUpdate( q, intensity, response ) {\r\n\r\n\r\n    if( arguments.length != 3){\r\n        throw new Error( \"Incorrect number of parameters (3) \");\r\n    }\r\n\r\n    if( q === undefined ){\r\n        throw new Error( \"q is undefined \" );\r\n    }\r\n\r\n    if( !(isFinite( intensity )) || (isNaN( intensity )) ){\r\n        throw new Error( \"Intensity must be real, not complex\" );\r\n    }   \r\n\r\n    if( response < 0 || response >= q.s2.length){\r\n        throw new Error( \"response \" + response + \" is out of range 0 to \" + q.s2.length);\r\n    }\r\n\r\n    if( q.updatePdf == 1 ){\r\n\r\n        var inten = Math.max( -1e10, Math.min( 1e10 , intensity)); \r\n        var ii = q.i.map( function( x ) { return q.pdf.length + x - Math.round(( inten - q.tGuess ) / q.grain ); } );\r\n\r\n        if( ii[ 0 ] < 1 || ii[ii.length - 1] > q.s2[0].length ){\r\n            if( q.warnPdf == 1 ){\r\n                let low= ( 1 - q.pdf.length - q.i[0] ) * q.grain + q.tGuess;\r\n                let high=( q.s2[0].length - q.pdf.length - q.i[q.i.length - 1] ) * q.grain + q.tGuess;\r\n                alert('QuestUpdate: intensity ' + inten + ' out of range ' + low + ' to ' + high + '. Pdf will be inexact. Suggest that you increase \"range\" in call to QuestCreate.');\r\n            }\r\n\r\n            if( ii[ 0 ] < 1){\r\n                ii = ii.map( function( x ) { return (x + 1 - ii[ 0 ]) ; }); \r\n            }\r\n\r\n            else {\r\n                ii = ii.map( function( x ) { return (x + q.s2[0].length - ii[ ii.length - 1]) ; }); \r\n            }\r\n        }\r\n        \r\n\r\n        for(let i = 0; i < ii.length; i++){\r\n            q.pdf[i] = q.pdf[i] * q.s2[response][ii[i] - 1];\r\n        }\r\n\r\n        if( q.normalizePdf ){\r\n            let sumPDF = sumVector(q.pdf); \r\n            q.pdf = q.pdf.map( function( x ) { return x / sumPDF; }); //avoid underflow; keep the pdf normalized // 3 ms\r\n        }\r\n    }\r\n\r\n    //keep a historical record of the trials\r\n    q.trialCount += 1;\r\n\r\n    if(q.trialCount > q.intensity.length){\r\n        // Out of space in preallocated arrays. Reallocate for additional\r\n        // 10000 trials. We reallocate in large chunks to reduce memory\r\n        // fragmentation.\r\n\r\n        for(let i = 0; i < 10000; i++){\r\n        q.intensity.push(0);\r\n        q.response.push(0);\r\n        }\r\n    }\r\n\r\n    for( let i = 0; i < q.trialCount; i++){\r\n\r\n        q.intensity[i] = 0.5; \r\n        q.response[i] = response; \r\n    }\r\n\r\n    return q; \r\n}\r\n\r\nexport function QuestTrials(q, binsize){\r\n    if( arguments.length < 1 ){\r\n        throw new Error('Usage: trial=QuestTrials(q,[binsize])');\r\n    }\r\n\r\n    if( arguments.length < 2 ){\r\n        binsize = []; \r\n    }\r\n\r\n    if( isEmpty( binsize ) || !isFinite( binsize )){\r\n        binsize = 0; \r\n    }\r\n\r\n    if( binsize < 0 ){\r\n        throw new Error('binsize cannot be negative');\r\n    }\r\n    \r\n    // sort\r\n    var inIntensity = q.intensity.slice(0, q.trialCount + 1);\r\n    var inResponse = q.response.slice(0, q.trialCount + 1);\r\n\r\n    var withIndex = [];\r\n    for (var i in inIntensity) {\r\n        withIndex.push([inIntensity[i], i]);\r\n    }\r\n    withIndex.sort(function(left, right) {\r\n        return left[0] < right[0] ? -1 : 1;\r\n        });\r\n\r\n    var indexes = [];\r\n    var intensity = [];\r\n\r\n    for (var j in withIndex) {\r\n        intensity.push(withIndex[j][0]);\r\n        indexes.push(withIndex[j][1]);\r\n    }\r\n\r\n    var response = []; \r\n\r\n    for(i = 0; i < indexes.length; i++){\r\n        response.push(inResponse[indexes[i]]);\r\n    }\r\n\r\n    //quantize\r\n    if( binsize > 0){\r\n        intensity = intensity.map(function(x) { return(Math.round( x / binsize ) * binsize); }); \r\n    }\r\n\r\n    // compact\r\n    j = 0;\r\n\r\n    var trial = {\r\n        intensity: [],\r\n        responses: [], \r\n    }\r\n\r\n    trial.intensity.push(intensity[0]); \r\n\r\n    for(i = 0; i < 2; i++){\r\n        trial.responses[i] = new Array(); \r\n        trial.responses[i].push(0); \r\n    }\r\n\r\n    for( i = 0; i < intensity.length; i++){\r\n        if(intensity[i] != trial.intensity[j]){\r\n            j += 1;\r\n            trial.intensity.push(intensity[i]);\r\n            for(i = 0; i < 2; i++){\r\n                trial.responses[i].push(0); \r\n            }\r\n        }\r\n        trial.responses[response[i]][j] = trial.responses[response[i]][j] + 1;\r\n    }\r\n\r\n    return trial; \r\n}\r\n\r\n\r\nexport function QuestStimulate(q, tTest, tActual, plotIt){\r\n    if( arguments.length < 3 ){\r\n        throw new Error('Usage: response=QuestSimulate(q,tTest,tActual[,plotIt])');\r\n    }\r\n\r\n    var linear = require('everpolate').linear\r\n\r\n    var x2min = Math.min(q.x2[0], q.x2[q.x2.length-1]);\r\n    var x2max = Math.max(q.x2[0], q.x2[q.x2.length-1]);\r\n    var t= Math.min(Math.max((tTest - tActual), x2min) , x2max);\r\n    var response = linear(t, q.x2, q.p2);\r\n\r\n    return response; \r\n}\r\n\r\n//t=QuestMean(q)\r\n//Get the mean threshold estimate.\r\n\r\nexport function QuestMean( q ){\r\n    if( arguments.length != 1 ){\r\n        throw new Error('Usage: t=QuestMean(q)');\r\n    }\r\n\r\n    let sumPDF = sumVector( q.pdf ); \r\n\r\n    let tempA = sumVector(multiplyVector(q.pdf, q.x)); \r\n\r\n    var t = q.tGuess + tempA / sumPDF;\t// mean of our pdf\r\n\r\n    return t; \r\n}\r\n\r\n//[t,p]=QuestMode(q)\r\n//\"t\" is the mode threshold estimate\r\n//\"p\" is the value of the (unnormalized) pdf at t.\r\nexport function QuestMode( q ){\r\n    if( arguments.length != 1 ){\r\n        throw new Error('Usage: t=QuestMode(q)');\r\n    }\r\n\r\n    let iMode = indexOfMax(q.pdf);\r\n    var t = q.x[iMode] + q.tGuess;\r\n    return t; \r\n}\r\n\r\n\r\n//sd=QuestSd(q)\r\n//Get the sd of the threshold distribution.\r\n\r\nexport function QuestSd( q ){\r\n    if( arguments.length != 1 ){\r\n        throw new Error('Usage: sd=QuestSd(q)');\r\n    }\r\n    let p = sumVector( q.pdf );\r\n    \r\n    var xSquared = q.x.map(function(x){return Math.pow(x, 2); }); \r\n    var Squared2 = sumVector( multiplyVector(q.pdf, q.x)) / p; ;\r\n\r\n    var sd = Math.sqrt( (sumVector(multiplyVector(q.pdf, xSquared)) / p) - Math.pow(Squared2, 2)) ; \r\n    return sd; \r\n}\r\n//p=QuestPdf(q,t)\r\n// The (possibly unnormalized) probability density of candidate threshold \"t\".\r\n// q and t may be vectors of the same size, in which case the returned p is a vector of that size.\r\nexport function QuestPdf( q, t ){\r\n    if( arguments.length != 2 ){\r\n        throw new Error('Usage: p=QuestPdf(q,t)');\r\n    }\r\n\r\n    var i= Math.round( ( t- q.tGuess ) / q.grain ) + 1 + q.dim / 2;\r\n    i = Math.min( q.pdf.length , Math.max( 1 , i ));\r\n    var p = q.pdf[i - 1];\r\n    return p; \r\n}\r\n\r\n// p=QuestP(q,x)\r\n// The probability of a correct (or yes) response at intensity x, assuming\r\n// threshold is at x=0.\r\nexport function QuestP( q, x ){\r\n\r\n    if( !isReal( x ) ){\r\n        throw new Error('x must be real, not complex.');\r\n    }\r\n\r\n    var p; \r\n    \r\n\r\n    if( x < q.x2[0] )\r\n        p = q.p2[0];\r\n    \r\n    else if( x > q.x2[q.x2.length-1] ){\r\n        p = q.p2[q.p2.length-1]; \r\n    }\r\n\r\n    else{\r\n        var linear = require('everpolate').linear\r\n        p = linear(0, q.x2, q.p2)[0];\r\n    }\r\n\r\n    if( !isFinite(p) ){\r\n        throw new Error('psychometric function ' + p + ' at ' + x);\r\n    }\r\n\r\n    return p; \r\n    \r\n\r\n}\r\n\r\n// intensity=QuestQuantile(q,[quantileOrder])\r\n//  Gets a quantile of the pdf in the struct q. You may specify the desired\r\n//  quantileOrder, e.g. 0.5 for median, or, making two calls, 0.05 and 0.95\r\n//  for a 90% confidence interval. If the \"quantileOrder\" argument is not\r\n//  supplied, then it's taken from the \"q\" struct. QuestCreate uses\r\n//  QuestRecompute to compute the optimal quantileOrder and saves that in the\r\n//  \"q\" struct; this quantileOrder yields a quantile  that is the most\r\n//  informative intensity for the next trial.\r\n\r\nexport function QuestQuantile( q, quantileOrder ){\r\n\r\n    if( arguments.length > 2 ){\r\n        throw new Error('Usage: intensity=QuestQuantile(q,[quantileOrder])');\r\n    }\r\n\r\n    if( arguments.length < 2 ){\r\n        quantileOrder = q.quantileOrder;\r\n    }\r\n\r\n    if( quantileOrder > 1 || quantileOrder < 0 ) {\r\n        throw new Error('quantileOrder' + quantileOrder + ' is outside range 0 to 1.');\r\n    }\r\n\r\n    var p = cumsum( q.pdf );\r\n\r\n    if( !isFinite ( p[p.length - 1] )) {\r\n        throw new Error('pdf is not finite');\r\n    }\r\n\r\n    if( p[p.length - 1] == 0) {\r\n        throw new Error('pdf is all zero');\r\n    }\r\n\r\n    var t; \r\n\r\n    if( quantileOrder < p[0] ){\r\n        t = q.tGuess + q.x[0];\r\n        return t;\r\n    }\r\n\r\n    if( quantileOrder > p[ p.length - 1] ){\r\n        t = q.tGuess + q.x[ q.x.length - 1];\r\n        return t;\r\n    }\r\n\r\n    var tempP = p.slice(); \r\n    \r\n    tempP.unshift(-1);\r\n\r\n    let tempA = diff( tempP );\r\n    var index = findZero( tempA );\r\n\r\n    \r\n\r\n    if( index.length < 2){\r\n\t    throw new Error('pdf has only ' + index.length + ' nonzero point(s)');\r\n    }\r\n\r\n    var linear = require('everpolate').linear\r\n\r\n    var temp1 = subarrayIndex(p, index);\r\n    var temp2 = subarrayIndex(q.x, index);\r\n\r\n    var t  = q.tGuess + (linear(quantileOrder * p[ p.length - 1 ], temp1, temp2)[0]);\r\n    return t; \r\n}\r\n\r\nexport function PAL_Gumbel(alpha, beta, gamma, lambda, x, varargin){\r\n\r\n    const math = require('mathjs');\r\n\r\n    if ( arguments.length < 5 || arguments.length > 6){\r\n        throw new Error(\"Incorrect number of parameters: alpha, beta, gamma, lambda, x, varargin\");\r\n    }\r\n\r\n    if(  varargin ){\r\n        if( varargin === 'Inverse' ){\r\n            if ( isArray(x)){\r\n                var y = x.map(function(t){\r\n                    var c = math.eval( \"(\" + t + \"-\" + gamma + \" ) / (1 - \" + gamma + \"-\" + lambda + \") - 1\");\r\n                    c = math.eval(\"-1 * log( -1 * \" + c + \")\");\r\n                    c = math.eval( \"log10( \" + c + \")\");\r\n                    c = math.divide(c, 2);\r\n                    return math.add(alpha, c); \r\n                })\r\n                \r\n            }\r\n            else{\r\n                var c = math.eval( \"(\" + x + \"-\" + gamma + \" ) / (1 - \" + gamma + \"-\" + lambda + \") - 1\");\r\n                c = math.eval(\"-1 * log( -1 * \" + c + \")\");\r\n                c = math.eval( \"log10( \" + c + \")\");\r\n                c = math.divide(c, 2);\r\n                var y = math.add(alpha, c); \r\n            }\r\n        }\r\n        if( varargin === 'Derivative' ){\r\n            if( isArray( x )){\r\n                var y = x.map(function(x){\r\n                    return math.eval(\"( 1 - \" + gamma + \" - \" + lambda + \") * e^(-1 * 10^(\" + beta + \"*\" + \"(\" + x + \"-\" + alpha + \"))) * log(10) * 10^( \" + beta + \"*(\" + x + \"-\" + alpha + \"))*\" + beta); \r\n                })\r\n            }\r\n            else{\r\n                var y = (1 - gamma - lambda) * Math.exp( -1  * Math.pow( 10, (beta *(x - alpha)))) * Math.log(10) * Math.pow(10, (beta *( x - alpha))) * beta;\r\n            }\r\n        }\r\n    }\r\n    \r\n    else{\r\n        if( isArray( x )){\r\n            var y = x.map(function(t){\r\n                return math.eval(gamma + \"+ ( 1 - \" + gamma + \" - \" + lambda + \") * ( 1 - e^(-1 * 10^(\" + beta + \"*\" + \"(\" + t + \"-\" + alpha + \"))))\"); \r\n            })\r\n        }\r\n        else{\r\n            var y = math.eval(gamma + \"+ ( 1 - \" + gamma + \" - \" + lambda + \") * ( 1 - e^(-1 * 10^(\" + beta + \"*\" + \"(\" + x + \"-\" + alpha + \"))))\"); \r\n            //var y = gamma + (1 - gamma - lambda) * (1 - Math.exp( -1  * Math.pow( 10, (beta *(x - alpha))))); \r\n        }\r\n    }\r\n\r\n    return y;\r\n    \r\n}\r\n\r\n//HELPER FUNCTIONS \r\n\r\nfunction subarrayIndex( arr, indices ){\r\n    var new_array = []\r\n\r\n    for( var i = 0; i < indices.length; i++){\r\n        new_array.push( arr[indices[i]] );\r\n    }\r\n\r\n    return new_array; \r\n}\r\n\r\nfunction findZero ( arr ){\r\n    var new_array = []\r\n\r\n    for(var i = 0; i < arr.length; i++ ){\r\n        if( arr[i] > 0 ){\r\n            new_array.push(i);\r\n        };\r\n    }\r\n\r\n    return new_array; \r\n}\r\n\r\nfunction diff( arr ){\r\n    var new_array = []\r\n\r\n    for(var i = 0; i < arr.length - 1; i++ ){\r\n        new_array.push( arr[ i + 1 ] - arr[ i ] );\r\n    }\r\n\r\n    return new_array; \r\n}\r\n\r\nexport function cumsum( arr ){\r\n    var new_array = []; \r\n    arr.reduce(function(a,b,i) { return new_array[i] = a+b; }, 0);\r\n    return new_array; \r\n}\r\n\r\n\r\nfunction multiplyVector(a,b){\r\n    return a.map((e,i) => e * b[i]);\r\n}\r\n\r\nexport function sumVector(v){\r\n    return v.reduce(( a, b ) => a + b, 0);\r\n}\r\n\r\nexport function indexOfMax(arr) {\r\n    if (arr.length === 0) {\r\n        return -1;\r\n    }\r\n\r\n    var max = arr[0];\r\n    var maxIndex = 0;\r\n\r\n    for (var i = 1; i < arr.length; i++) {\r\n        if (arr[i] > max) {\r\n            maxIndex = i;\r\n            max = arr[i];\r\n        }\r\n    }\r\n\r\n    return maxIndex;\r\n}\r\n\r\nfunction isReal( x ){\r\n    if( !(isFinite( x )) || (isNaN( x )) ){\r\n        return false;\r\n    }\r\n    else{ return true; }\r\n}\r\n","import { sumVector, QuestPdf, QuestRecompute, QuestCreate, QuestMean, QuestSd, QuestQuantile, QuestUpdate, PAL_Gumbel, indexOfMax } from \"./Quest.js\"\r\n\r\nexport function test(){\r\n    const math = require('mathjs');\r\n\r\n    var tGuess = 0.5,\r\n      tGuessSd = 0.1,\r\n      pThreshold = 0.75,\r\n      beta = 3.5,\r\n      delta = 0.01,\r\n      gamma = 0.01,\r\n      grain = 0.001,\r\n      range = .05;\r\n    var q1 = QuestCreate(tGuess, tGuessSd, pThreshold, beta, delta, gamma, grain, range);\r\n\r\n    //console.log(q1); \r\n    var q2 = QuestCreate(tGuess, tGuessSd, pThreshold, beta, delta, gamma, grain, range);\r\n    q2.updatePdf = 1; \r\n    q2 = QuestUpdate(q2, 0.5, 1);\r\n    console.log(q2)\r\n    var t1 = QuestMean(q1);\t\t// Recommended by Pelli (1989) and King-Smith et al. (1994) as the best way to ascertain threshold.\r\n    var sd1 = QuestSd(q2);\r\n\r\n    var t2 = QuestMean(q2);\t\t// Recommended by Pelli (1989) and King-Smith et al. (1994) as the best way to ascertain threshold.\r\n    var sd2 = QuestSd(q2);\r\n\r\n    // Take the arithmetic mean of these two threshold (75%) estimates.\r\n    var tmean = math.mean([t1, t2]);\r\n    var sdmean = math.mean([sd1, sd2]);\r\n\r\n    console.log(t1, sd1, t2, sd2, tmean, sdmean);\r\n}\r\n\r\nexport function vis_quest( trialsDesired, tGuess_1, tGuessSd_1, tGuess_2, tGuessSd_2, pThreshold, beta, delta, gamma ){\r\n\r\n    var q1= QuestCreate(tGuess_1, tGuessSd_1, pThreshold, beta, delta, gamma);\r\n    q1.normalizePdf = 1;\r\n\r\n    var q2 = QuestCreate(tGuess_2, tGuessSd_2, pThreshold, beta, delta, gamma);\r\n    q2.normalizePdf = 1;\r\n\r\n    // Quest Trial numbers\r\n    var q1_trialnum = 0;\r\n    var q2_trialnum = 0;\r\n    var k = 0;                      //overall trial numbers\r\n    var frame = 0; \r\n    var log_contrast_1;\r\n    var log_contrast_2;\r\n    var currentQ = 0; \r\n\r\n    console.log(q1); \r\n\r\n    while(k < (trialsDesired * 2)){\r\n        var nowTime = new Date().getTime() / 1000;     \r\n\r\n        \r\n        k += 1; \r\n\r\n        if(q1_trialnum == q2_trialnum){  // if equal trial numbers, time to go to the next one for staircase 1_\r\n                q1_trialnum = q1_trialnum + 1;\r\n                currentQ = 1;\r\n        }\r\n        if(q1_trialnum != q2_trialnum){  // cannot have multiple if and else blocks in Javascript\r\n            q2_trialnum = q2_trialnum + 1;\r\n            currentQ = 2;\r\n        }\r\n        if( currentQ == 1 ){\r\n            \r\n            if(k == 1){\r\n                log_contrast_1 = tGuess_1 + 0.3;  //  Make this procedure go from high to low contrast.\r\n            }\r\n            // if(k != 1){\r\n            //     if !isNaN(trialdata_1{q_1_trialnum-1,2})  // Repeat last level if pt did not have recorded response.\r\n            //             log_contrast_1=QuestQuantile(q_1) // Recommended by Pelli (1987), and still our favorite\r\n            // }\r\n            // if ~isnan(trialdata_1{q_1_trialnum,2})\r\n            //q_1=QuestUpdate(q_1,log_contrast_1,accuracy_1(q_1_trialnum,1)); % Add the new datum (actual test intensity and observer response) to the database.\r\n\r\n            ///////////////////////////DOES TRIALDATA ISNAN HAVE TO BE INCLUDED? //////////////////////////////////////\r\n\r\n            else{\r\n                if( k == 2 ){\r\n                    log_contrast_2 = tGuess_2 - 0.3;  // Make this procedure go from low to high contrast\r\n                }\r\n                else{\r\n                    log_contrast_2 = QuestQuantile(q2);\r\n                }\r\n            }\r\n        }\r\n                \r\n    }\r\n\r\n    const math = require('mathjs');\r\n\r\n    //Statistics\r\n    var t1 = QuestMean(q1);\t\t// Recommended by Pelli (1989) and King-Smith et al. (1994) as the best way to ascertain threshold.\r\n    var sd1= QuestSd(q1);\r\n    \r\n    var t2 = QuestMean(q2);\t\t// Recommended by Pelli (1989) and King-Smith et al. (1994) as the best way to ascertain threshold.\r\n    var sd2 = QuestSd(q2);\r\n    \r\n    // Take the arithmetic mean of these two threshold (75%) estimates.\r\n    var tmean = math.mean([t1,t2]);\r\n    var sdmean = math.mean([sd1,sd2]);\r\n\r\n    var lambda = 0; // normally in config file//////////////////////\r\n    var gamma = 0.01; // normally in config file//////////////////////\r\n\r\n    var intensities = gumbel_intensities(q1, q2, tmean, lambda, gamma);\r\n\r\n    return intensities; \r\n}\r\n\r\n//   To be used within context of QUEST-like program.  Defines intensities at\r\n//   which participants are likely to detect tone in noise at 75%\r\n//   (threshold), 50%, 25% probabilities.  First row of returned matrix are\r\n//   these labels.  The second gives the intensities in decibels, the third\r\n//   in scale units (coefficient used to scale full-scaled tone).  Required\r\n//   inputs are the QUEST structures produced by the CH QUEST procedure via\r\n//   ch_auditory_quest. q_1 and q_2 variables are the structures produced by\r\n//   the QUEST procedure.  t_mean is the arithmetic mean of the two threshold\r\n//   estimates produced by the two interleaved staircases.\r\n\r\nexport function process_data( q1, q2 ) {\r\n    const math = require('mathjs');\r\n\r\n    //Statistics\r\n    var t1 = QuestMean(q1);\t\t// Recommended by Pelli (1989) and King-Smith et al. (1994) as the best way to ascertain threshold.\r\n    var sd1 = QuestSd(q1);\r\n\r\n    var t2 = QuestMean(q2);\t\t// Recommended by Pelli (1989) and King-Smith et al. (1994) as the best way to ascertain threshold.\r\n    var sd2 = QuestSd(q2);\r\n\r\n    // Take the arithmetic mean of these two threshold (75%) estimates.\r\n    var tmean = math.mean([t1, t2]);\r\n    var sdmean = math.mean([sd1, sd2]);\r\n\r\n    var lambda = 0; // normally in config file//////////////////////\r\n    var gamma = 0.01; // normally in config file//////////////////////\r\n\r\n    var intensities = gumbel_intensities(q1, q2, tmean, lambda, gamma);\r\n\r\n    return intensities; \r\n  }\r\n\r\n  export function gumbel_intensities(q1, q2, tmean, lambda, gamma){\r\n\r\n    var returnStruct = {\r\n        intensities: [],\r\n        parameters: [],\r\n        beta: 0,\r\n    }\r\n\r\n    var intensities = []\r\n    intensities.push( [ 25, 50, 75, 90 ] );\r\n    intensities.push( [] );\r\n\r\n    const math = require('mathjs');\r\n\r\n    var parameters = []; \r\n\r\n    parameters.push(ch_QuestBetaAnalysis(q1));\r\n    parameters.push(ch_QuestBetaAnalysis(q2));\r\n    \r\n    returnStruct.parameters = parameters; \r\n\r\n    var mean_beta = 3.5;  // changed 3/25/2019. Trying fixed beta at 3.5 (suggested generic beta value by Quest documentation) instead of individually estimating.\r\n    var mean_alpha = tmean;\r\n    var estimate_beta = math.mean(q1.beta, q2.beta);\r\n    returnStruct.beta = estimate_beta;\r\n\r\n    console.log(mean_alpha, mean_beta, gamma, lambda); \r\n\r\n    var fzero = require(\"fzero\");\r\n\r\n    var fn90 = function (x) { return( PAL_Gumbel(mean_alpha, mean_beta, gamma, lambda, x) - 0.90 ).toString(); };\r\n    var fn75 = function (x) { return( PAL_Gumbel(mean_alpha, mean_beta, gamma, lambda, x) - 0.75 ).toString(); };\r\n    var fn50 = function (x) { return( PAL_Gumbel(mean_alpha, mean_beta, gamma, lambda, x) - 0.50 ).toString(); };\r\n    var fn25 = function (x) { return ( PAL_Gumbel(mean_alpha, mean_beta, gamma, lambda, x) - 0.25).toString();  };\r\n\r\n    var zero = fzero(fn25, 2).solution;\r\n    //var zero = PAL_Gumbel(mean_alpha, mean_beta, gamma, lambda, 0);\r\n    intensities[1].push( parseFloat(fzero(fn25, 2).solution) );\r\n    intensities[1].push( parseFloat(fzero(fn50, 2).solution) );\r\n    intensities[1].push( parseFloat(fzero(fn75, 2).solution) );\r\n    intensities[1].push( parseFloat(fzero(fn90, 2).solution) );\r\n    intensities.push(intensities[1]);\r\n\r\n    returnStruct.intensities = intensities; \r\n    console.log( returnStruct ); \r\n\r\n    return returnStruct;\r\n  }\r\n\r\nexport function ch_QuestBetaAnalysis( q ){\r\n    \r\n    const math = require('mathjs');\r\n\r\n    var q2 =  QuestCreate( q.tGuess, q.tGuessSd, q.pThreshold, math.eval(\"2^(1/4)\"), q.delta, q.gamma, 0.02);\r\n    q2.dim = 250; \r\n    \r\n    var qq = QuestRecompute( q2 ); \r\n    var p = sumVector(qq.pdf); \r\n\r\n\r\n    if( p == 0 ){\r\n        throw new Error(\"Beta has zero probability, \", p);\r\n    }\r\n\r\n    q2 = qq; \r\n\r\n    var t2 = QuestMean( q2 ); // estimate threshold for each possible beta\r\n    var p2 = QuestPdf( q2, t2 ); // get probability of each of these (threshold,beta) combinations\r\n    var sd2 = QuestSd( q2 ); // get sd of threshold for each possible beta\r\n    var beta2 = q2.beta;\r\n\r\n\r\n    var modeP = p2;\r\n    var t = t2; \r\n    var sd = QuestSd(q2);\r\n    var betaMean = math.sum(p2 * beta2) / modeP;\r\n    var betaSd = math.sqrt(math.sum(p2 * math.pow(beta2, 2)) / modeP - math.pow((math.sum(p2 * beta2)/ modeP), 2)); \r\n\r\n    var iBetaMean = math.sum( p2 / beta2) / modeP;\r\n    var iBetaSd = math.sqrt(math.sum(p2 / math.pow(beta2, 2)) / modeP - math.pow((math.sum(p2/beta2) / modeP), 2));\r\n    var betaEstimate = 1 / iBetaMean;\r\n\r\n    var returnStruct = {\r\n        t: t,\r\n        sd: sd, \r\n        betaEstimate: betaEstimate, \r\n        iBetaSd: iBetaSd, \r\n    }\r\n\r\n    return returnStruct\r\n}","export const add_response_1 = ( item ) => ({\n  type: 'ADD_RESPONSE_1',\n  payload: item\n})\n\nexport const add_response_time_1 = ( item ) => ({\n  type: 'ADD_RESPONSE_TIME_1',\n  payload: item\n})\n\nexport const add_contrast_1 = ( item ) => ({\n  type: 'ADD_CONTRAST_1',\n  payload: item\n})\n\nexport const add_array = ( arr ) => ({\n  type: 'ADD_ARRAY',\n  payload: arr\n})","import React, { Component } from 'react';\r\nimport logo from \"../media/psych_logo.jpg\"\r\nimport './Welcome.css';\r\nimport { Redirect } from \"react-router-dom\";\r\nimport { QuestCreate, QuestRecompute, QuestTrials, QuestUpdate, QuestStimulate, QuestMean, QuestMode, QuestSd, QuestP, QuestPdf, QuestQuantile, PAL_Gumbel, cumsum } from \"../Quest.js\"\r\nimport { ch_QuestBetaAnalysis, process_data } from \"../VisualQuest.js\"\r\n\r\nimport { connect } from 'react-redux'\r\nimport { add_array, add_response_1 } from '../actions/data'\r\n\r\n\r\nclass Welcome extends Component {\r\n\r\n  constructor(props) {\r\n    super(props); \r\n    this.keyFunction = this.keyFunction.bind(this); \r\n    this.state = {\r\n      continue: false,\r\n    }\r\n  }\r\n\r\n  keyFunction(event){\r\n    if(event.keyCode === 81) {\r\n      alert(\"User has Requested to Continue\");\r\n      this.setState((state, props) => ({\r\n        continue: true\r\n      }));\r\n    }\r\n  }\r\n\r\n  componentDidMount(){\r\n    document.addEventListener(\"keydown\", this.keyFunction, false);\r\n  }\r\n  componentWillUnmount(){\r\n    document.removeEventListener(\"keydown\", this.keyFunction, false);\r\n  }\r\n\r\n  render() {\r\n    var tGuess = 0.5,\r\n      tGuessSd = 0.1,\r\n      pThreshold = 0.75,\r\n      beta = 3.5,\r\n      delta = 0.01,\r\n      gamma = 0.01,\r\n      grain = 0.001,\r\n      range = .05;\r\n      \r\n    var q1 = QuestCreate(tGuess, tGuessSd, pThreshold, beta, delta, gamma, grain, range);\r\n\r\n    console.log(q1); \r\n    var q2 = QuestCreate(tGuess, tGuessSd, pThreshold, beta, delta, gamma, grain, range);\r\n    q2.updatePdf = 1; \r\n    q2 = QuestUpdate(q2, 0.5, 1);\r\n\r\n    process_data( q1, q2 );\r\n\r\n    if(this.state.continue === true){\r\n      return <Redirect to=\"/Instructions\" />\r\n    }\r\n\r\n    return (\r\n      <div className=\"Welcome\">\r\n        <input type=\"hidden\"/>\r\n        <header className=\"Welcome-header\">\r\n        <div className=\"text-container\">\r\n          <p className=\"Welcome-text\">\r\n            <span className=\"bigger\">Welcome to the study! </span>\r\n            <br /><br />Please enter responses to the questions asked by pressing the: \r\n            <br /><br /><b> 'Q' key for 'YES I SEE IT'</b> or <b> 'E' key for \"NO I DO NOT'</b>\r\n            <br /><br /><br /><br /> Sometimes it may be difficult to answer, but if you do not know, please make your best guess.\r\n            <br /><br /><br /><br /> PRESS the <b> YES I SEE IT / 'Q' key</b> to CONTINUE\r\n            \r\n          </p>\r\n        </div>      \r\n          <a\r\n            href=\"https://medicine.yale.edu/psychiatry/care/cmhc/\"\r\n            title=\"Learn more about the Connecticut Mental Health Center\"\r\n            target=\"_blank\"\r\n            rel=\"noopener noreferrer\"\r\n          >\r\n          <img src={logo} className=\"Site-link\" alt=\"logo\" />\r\n          </a>\r\n\r\n        </header>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\n\r\nconst mapStateToProps = state => ({\r\n  data: state.data,\r\n})\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  add_response_1: ( elem ) => dispatch(add_response_1( elem )),\r\n  add_array: ( arr ) => dispatch(add_array( arr )),\r\n})\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Welcome)","import React, { Component } from 'react';\r\nimport './Instructions.css';\r\nimport { Redirect } from \"react-router-dom\";\r\n\r\nclass Instructions extends Component {\r\n\r\n    constructor(props) {\r\n        super(props); \r\n        this.keyFunction = this.keyFunction.bind(this); \r\n        this.state = {\r\n          continue: false,\r\n        }\r\n      }\r\n    \r\n      keyFunction(event){\r\n        if(event.keyCode === 81) {\r\n          alert(\"User has Requested to Continue\");\r\n          this.setState((state, props) => ({\r\n            continue: true\r\n          }));\r\n        }\r\n      }\r\n    \r\n      componentDidMount(){\r\n        document.addEventListener(\"keydown\", this.keyFunction, false);\r\n      }\r\n      componentWillUnmount(){\r\n        document.removeEventListener(\"keydown\", this.keyFunction, false);\r\n      }\r\n    \r\n      render() {\r\n    \r\n        if(this.state.continue === true){\r\n          return <Redirect to=\"/Trial\" />\r\n        }\r\n    \r\n        return (\r\n          <div className=\"Instructions\">\r\n            <input type=\"hidden\"/>\r\n            <header className=\"Instructions-header\">\r\n            <div className=\"text-container\">\r\n              <p className=\"Instructions-text\">\r\n                This is a vision test. \r\n                <br /><br /> A visual white noise will be shown throughout the experiment.\r\n                <br /><br /> A striped-texture will appear inside the white noise when a tone is played. \r\n                <br /><br /> Press <b> \"Q\"/YES </b> if you <b> DO </b>see the stripes. \r\n                <br /><br /> Press <b> \"E\"/NO </b> if you <b> DO NOT </b> see the stripes. \r\n                <br /><br /> Please respond as <b> QUICKLY </b> and as <b> ACCURATELY </b> as you <b> POSSIBLY CAN </b> \r\n                <br /><br /><br /> PRESS \"Q\"/YES TO BEGIN A SHORT PRACTICE SESSION\r\n                \r\n              </p>\r\n            </div>     \r\n            </header>\r\n          </div>\r\n        );\r\n      }\r\n    }\r\n\r\nexport default Instructions;\r\n","export function createStim( ){\r\n    var stim = {\r\n        background: 255/2,\r\n        angle: Math.floor(Math.random() * 135) + 45,   // returns a random integer from 45 to 135\r\n        imsize: 256, \r\n        initcontrast:  0.5,                  // initial contrast\r\n        threshold:     0.2,                  // moch treshold\r\n        phases: [0, 0.25],                   // phases either 0 and 0.25\r\n        phase: 0,\r\n        alpha: 0.5, \r\n        ppd: 160, \r\n        frequency: 0,                  // gabor spatial frequency\r\n    }\r\n\r\n    stim.phase = stim.phases[Math.round(Math.random())];\r\n    stim.frequency = 2 / stim.ppd; \r\n\r\n    return stim;\r\n};\r\n\r\nexport function createGabor( stim, contrast ){\r\n\r\n    var xs = []\r\n    var ys = []\r\n\r\n    for (var x = 1; x < stim.imsize + 1; x++ ){\r\n        for (var y = 1; y < stim.imsize + 1; y++ ){\r\n            xs[((x -1) + (y - 1) * stim.imsize) * 4 + 0] = x - ((stim.imsize + 1) / 2);\r\n            xs[((x -1) + (y - 1) * stim.imsize) * 4 + 1] = x - ((stim.imsize + 1) / 2);\r\n            xs[((x -1) + (y - 1) * stim.imsize) * 4 + 2] = x - ((stim.imsize + 1) / 2);\r\n            xs[((x -1) + (y - 1) * stim.imsize) * 4 + 3] = x - ((stim.imsize + 1) / 2);\r\n\r\n            ys[((x -1) + (y - 1) * stim.imsize) * 4 + 0] = y - ((stim.imsize + 1) / 2);\r\n            ys[((x -1) + (y - 1) * stim.imsize) * 4 + 1] = y - ((stim.imsize + 1) / 2);\r\n            ys[((x -1) + (y - 1) * stim.imsize) * 4 + 2] = y - ((stim.imsize + 1) / 2);\r\n            ys[((x -1) + (y - 1) * stim.imsize) * 4 + 3] = y - ((stim.imsize + 1) / 2);\r\n        }\r\n    }\r\n\r\n    var patch = []; \r\n\r\n    for(var i = 0; i < xs.length && i < ys.length; i++){\r\n        patch[i] = 0.5 * Math.cos(2 * Math.PI * (stim.frequency * (Math.sin( Math.PI / 180 * stim.angle) * xs[i] + Math.cos( Math.PI / 180 * stim.angle) * ys[i] ) + stim.phase)) * contrast; \r\n    }\r\n\r\n    var grating = patch.map( function(x) { return (stim.background + (x * stim.background)); });\r\n\r\n    return grating; \r\n}\r\n\r\nexport function blendfun( alpha, a, b ){\r\n    var stimulusArr = [];\r\n\r\n    for (var x = 0; x < a.length && x < b.length; x++ ){\r\n        stimulusArr[x] = alpha * a[x] + (1 - alpha) * b[x]; \r\n    }\r\n\r\n    return stimulusArr; \r\n}\r\n\r\n","import React, { Component } from 'react';\r\nimport './Trial.css';\r\nimport { Redirect } from \"react-router-dom\";\r\nimport { createStim, createGabor } from \"../Stim.js\"\r\n\r\nimport { connect } from 'react-redux'\r\nimport { add_array, add_response_1, add_response_time_1, add_contrast_1 } from '../actions/data'\r\n\r\nclass Trial extends Component {\r\n\r\n    constructor(props) {\r\n        super(props); \r\n        this.keyFunction = this.keyFunction.bind(this); \r\n        this.create_noise = this.create_noise.bind(this);  \r\n        this.state = {\r\n          continue: false,\r\n          counter: 0,\r\n\r\n          responses_1: [],\r\n          contrast_array_1: [],\r\n          response_time_1: [],\r\n          ratings_1: [],\r\n\r\n          responses_2: [],\r\n          contrast_array_2: [],\r\n          response_time_2: [],\r\n          ratings_2: [],\r\n\r\n          time_window: false,\r\n          time_window_start: 0,\r\n          time_window_rating: false, \r\n          limit: 100,\r\n\r\n\r\n          contrast_flag: 1, //1 for contrast 1 and 2 for contrast 2\r\n\r\n        }\r\n        this.canvasRef = React.createRef(); \r\n        this.audioContext = new AudioContext();\r\n      }\r\n\r\n      create_noise( audioContext, callback ){\r\n\r\n        // contrast values\r\n        var c25 = 0.2;\r\n        var c50 = 0.5;\r\n        var c75 = 0.75;\r\n\r\n        //train_test arrays\r\n        var tt1 = [c25, c50, c75 ];\r\n        var end = tt1.length; \r\n        var contrast_block = tt1; \r\n        var index = 0; \r\n\r\n        var SimplexNoise = require('simplex-noise');\r\n        \r\n        var simplex = new SimplexNoise(),\r\n          canvas = document.getElementById('c'),\r\n          ctx = canvas.getContext('2d'),\r\n          imgdata = ctx.getImageData(0, 0, canvas.width, canvas.height),\r\n          data = imgdata.data,\r\n          t = 0;\r\n        \r\n        var stim = createStim(); \r\n        var stimulus_blank = createGabor( stim, 0 ); \r\n        \r\n        var stimulus; \r\n        var jitter = Math.floor(Math.random()* 20); //jitter tone presentation 0-500ms per trial\r\n        var start_time = 100;\r\n        var contrast = 0; \r\n        var intervalId = undefined; \r\n\r\n        var that = this;\r\n        var seconds = 0; \r\n\r\n        async function generate_noise( ){\r\n\r\n            if ( t == start_time + jitter){\r\n              index = that.state.counter; \r\n\r\n              contrast = contrast_block[index++];\r\n              console.log(contrast); \r\n\r\n              var seconds = new Date().getTime() / 1000;\r\n\r\n              console.log(\"time on \", seconds);\r\n\r\n              that.setState({ \r\n                time_window: true, \r\n                time_window_rating: true, \r\n                time_window_start: seconds,\r\n              });\r\n\r\n              console.log(that.state.responses_1, that.state.ratings_1, that.state.response_time_1, that.state.contrast_array_1); \r\n\r\n              stimulus = createGabor( stim, contrast ); \r\n              beep(50, 830, 300, audioContext); //beep for arg3 miliseconds\r\n            }\r\n\r\n            for (var x = 0; x < 256; x++) {\r\n              for (var y = 0; y < 256; y++) {\r\n                if(t == start_time + jitter || t == start_time + jitter + 1 || t == start_time + jitter + 2|| t == start_time+ jitter+3 || t == start_time + jitter+4\r\n                  || t == start_time+ jitter + 5 || t == start_time+ jitter +6 || t == start_time+ jitter +7|| t == start_time + jitter+8|| t == start_time+ jitter+9\r\n                  || t == start_time + jitter+ 10|| t == start_time+ jitter +11|| t == start_time+ jitter +12|| t == start_time + jitter+13|| t == start_time+ jitter+14\r\n                  || t == start_time + jitter+ 15|| t == start_time + jitter + 16|| t == start_time+ jitter +17|| t == start_time + jitter +18|| t == start_time+ jitter +19\r\n                  || t == start_time+ jitter + 20|| t == start_time+ jitter + 21|| t == start_time+ jitter + 22|| t == start_time+ jitter + 23|| t == start_time+ jitter + 24\r\n                  || t == start_time+ jitter + 25|| t == start_time+ jitter + 26|| t == start_time+ jitter + 27|| t == start_time+ jitter + 28|| t == start_time+ jitter + 29\r\n                  || t == start_time+ jitter + 30){\r\n                  if( t == start_time+ jitter +30 ){\r\n                    t = 0;\r\n                    //during beep show signal, then reset timer to 0\r\n                  }\r\n\r\n                  var r = simplex.noise3D(x / 8, y / 8, t/8)* 0.4 + 0.35;\r\n                  data[(x + y * 256) * 4 + 0] = stim.alpha * stimulus[(x + y * 256) * 4 + 0] + (1 - stim.alpha) * r * 250;\r\n                  data[(x + y * 256) * 4 + 1] = stim.alpha * stimulus[(x + y * 256) * 4 + 1] + (1 - stim.alpha) * r * 250;\r\n                  data[(x + y * 256) * 4 + 2] = stim.alpha * stimulus[(x + y * 256) * 4 + 2] + (1 - stim.alpha) * r * 250;\r\n                  data[(x + y * 256) * 4 + 3] = 255;\r\n                }\r\n\r\n                else{\r\n\r\n                  seconds = new Date().getTime() / 1000\r\n\r\n                  if(that.state.time_window_start + 2 == seconds){\r\n                    that.setState({ \r\n                      time_window: false,\r\n                      time_window_rating: false,  \r\n                    });\r\n\r\n                    if(that.state.contrast_array_1.length < that.state.responses_1.length){\r\n                      that.setState({ contrast_array_1: that.state.contrast_array_1.concat([contrast]) });\r\n                    }\r\n\r\n                    if( that.state.responses_1.length != that.state.ratings_1.length ){\r\n\r\n                      if( that.state.responses_1.length > that.state.ratings_1.length ){\r\n\r\n                        console.log(\"response and response time discarded\", that.state.responses_1, that.state.response_time_1, that.state.ratings_1, that.state.contrast_array_1);\r\n\r\n                        that.setState({\r\n                          responses_1: that.state.responses_1.slice(0, that.state.ratings_1.length),\r\n                          response_time_1: that.state.response_time_1.slice(0, that.state.ratings_1.length),\r\n                          counter: that.state.counter - 1, \r\n                          contrast_array_1: that.state.contrast_array_1.slice(0, that.state.ratings_1.length)\r\n                        });\r\n                      }\r\n\r\n                      else{\r\n                        console.log(\"rating discarded\", that.state.responses_1, that.state.ratings_1, that.state.contrast_array_1);\r\n\r\n                        that.setState({\r\n                          ratings_1: that.state.ratings_1.slice(0, that.state.responses_1.length), \r\n                        });\r\n                      }\r\n                    }\r\n                    console.log(\"time off \", seconds);\r\n                  }\r\n\r\n\r\n                  var r = simplex.noise3D(x / 8, y / 8, t/8) * 0.4 + 0.35;\r\n                  data[(x + y * 256) * 4 + 0] = stim.alpha * stimulus_blank[(x + y * 256) * 4 + 0] + (1 - stim.alpha) * r * 250;\r\n                  data[(x + y * 256) * 4 + 1] = stim.alpha * stimulus_blank[(x + y * 256) * 4 + 1] + (1 - stim.alpha) * r * 250;\r\n                  data[(x + y * 256) * 4 + 2] = stim.alpha * stimulus_blank[(x + y * 256) * 4 + 2] + (1 - stim.alpha) * r * 250;\r\n                  data[(x + y * 256) * 4 + 3] = 255;\r\n                  //if there is no beep, show blank signal\r\n                }\r\n              }\r\n            }\r\n\r\n            t++;\r\n            ctx.putImageData(imgdata, 0, 0);\r\n            \r\n            var recWidth = canvas.width / 8;\r\n            var recHeight = canvas.height / 8;\r\n\r\n            var xPos = (canvas.width/2) - (recWidth/2);\r\n\r\n            var yPos = (canvas.height/2) - (recHeight/2);\r\n            var img=new Image();\r\n            img.src = \"https://www.shareicon.net/data/256x256/2015/12/04/682310_cross_512x512.png\";\r\n            ctx.fillStyle = \"gray\";\r\n            \r\n            ctx.fillRect(xPos, yPos, recWidth, recHeight);\r\n            ctx.drawImage(img, xPos, yPos, recWidth, recHeight);\r\n\r\n            if(index == end ){\r\n              window.cancelAnimationFrame(intervalId); \r\n              for(var g = 0; g < end; g++){\r\n                that.props.add_response_1( that.state.responses_1[g] );\r\n                that.props.add_response_time_1( that.state.response_time_1[g] );\r\n                that.props.add_contrast_1( that.state.contrast_array_1[g] );\r\n              }\r\n\r\n              that.audioContext.close();\r\n              that.setState({ continue: true });\r\n              return;\r\n            }\r\n\r\n            if(index < end){\r\n              intervalId = window.requestAnimationFrame(generate_noise);\r\n            }\r\n\r\n          }\r\n\r\n          generate_noise.call(that);\r\n\r\n      }\r\n    \r\n      keyFunction(event){\r\n        var seconds = new Date().getTime() / 1000\r\n\r\n        if(event.keyCode === 81 && this.state.time_window == true){\r\n\r\n          // Set setState\r\n          this.setState({\r\n            counter: this.state.counter + 1, \r\n            responses_1: this.state.responses_1.concat([1]),\r\n            response_time_1: this.state.response_time_1.concat([ seconds - this.state.time_window_start]),\r\n            time_window: false, \r\n          });\r\n\r\n          if(this.state.counter == this.state.limit){\r\n            this.setState({ continue: true });\r\n          }\r\n\r\n        }\r\n\r\n        if(event.keyCode === 69 && this.state.time_window == true) {\r\n          this.setState({\r\n            counter: this.state.counter + 1, \r\n            responses_1: this.state.responses_1.concat([0]),\r\n            response_time_1: this.state.response_time_1.concat([ seconds - this.state.time_window_start]),\r\n            time_window: false, \r\n          });\r\n\r\n          if(this.state.counter == this.state.limit){\r\n            this.setState({ continue: true });\r\n          }\r\n        }\r\n\r\n\r\n        if( ( event.keyCode === 49 || event.keyCode === 50 || event.keyCode === 51 || event.keyCode === 52 || event.keyCode === 53) && this.state.time_window_rating == true){\r\n          this.setState({\r\n            ratings_1: this.state.ratings_1.concat([event.keyCode - 48]),\r\n            time_window_rating: false, \r\n          });\r\n        }\r\n      }\r\n    \r\n      componentDidMount(){\r\n        document.addEventListener(\"keydown\", this.keyFunction, false);\r\n        if(this.state.continue == false){\r\n          this.create_noise( this.audioContext ); \r\n        }\r\n      }\r\n      componentWillUnmount(){\r\n        document.removeEventListener(\"keydown\", this.keyFunction, false);\r\n      }\r\n      \r\n      render() { \r\n\r\n        if(this.state.continue == true){\r\n          alert(\"Trial completed\")\r\n          return <Redirect to=\"/Complete\" />\r\n        }\r\n    \r\n        return (\r\n          <div className=\"Trial\">\r\n            <input type=\"hidden\"/>\r\n            <header className=\"Trial-header\">\r\n            <canvas id=\"c\" width=\"256\" height=\"256\" \r\n              style={{ zIndex:\"0\", position: \"fixed\", left: \"25%\",width: '50%', height:'auto'}}></canvas>\r\n            <canvas id=\"c2\" width=\"256\" height=\"256\" \r\n              style={{ zIndex:\"1\", position: \"fixed\", left: \"25%\", width: '50%', height:'auto'}}></canvas>\r\n            </header>\r\n          </div>\r\n        );\r\n      }\r\n    }\r\n\r\nconst mapStateToProps = state => ({\r\n  data: state.data,\r\n})\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  add_response_1: ( element ) => dispatch(add_response_1( element )),\r\n  add_response_time_1: ( element ) => dispatch(add_response_time_1( element )),\r\n  add_contrast_1: ( element ) => dispatch(add_contrast_1( element )),\r\n  add_array: ( arr ) => dispatch(add_array( arr )),\r\n})\r\n  \r\nexport default connect(mapStateToProps, mapDispatchToProps)(Trial);\r\n\r\n\r\nfunction beep(amp, freq, ms, audioContext){//amp:0..100, freq in Hz, ms\r\n  if (!audioContext) return;\r\n  var osc = audioContext.createOscillator();\r\n  var gain = audioContext.createGain();\r\n  osc.connect(gain);\r\n  osc.value = freq;\r\n  gain.connect(audioContext.destination);\r\n  gain.gain.value = amp/100;\r\n  osc.start(audioContext.currentTime);\r\n  osc.stop(audioContext.currentTime+ms/1000);\r\n }\r\n\r\n //array shuffling function, used to randomize order of presentation for different blocks\r\nfunction shuffle (array) {\r\n  var i = 0\r\n  var j = 0\r\n  var temp = null\r\n\r\n  for (i = array.length - 1; i > 0; i -= 1) {\r\n    j = Math.floor(Math.random() * (i + 1))\r\n    temp = array[i]\r\n    array[i] = array[j]\r\n    array[j] = temp\r\n    }\r\n  }\r\n\r\n  ","import React from \"react\";\r\nimport \"./NotFound.css\";\r\n\r\nexport default () =>\r\n  <div className=\"NotFound\">\r\n    <h3>Sorry, page not found!</h3>\r\n  </div>;","import React, { Component } from 'react';\r\nimport './Complete.css';\r\nimport { connect } from 'react-redux'\r\nimport { Redirect } from \"react-router-dom\";\r\n\r\nclass Complete extends Component {\r\n\r\n    constructor(props) {\r\n        super(props); \r\n      this.keyFunction = this.keyFunction.bind(this); \r\n      this.state = {\r\n        continue: false,\r\n      }\r\n    }\r\n\r\n    keyFunction(event){\r\n    if(event.keyCode === 81) {\r\n      alert(\"User has Requested to Continue\");\r\n      this.setState((state, props) => ({\r\n        continue: true\r\n      }));\r\n    }\r\n  }\r\n\r\n   componentDidMount(){\r\n    document.addEventListener(\"keydown\", this.keyFunction, false);\r\n  }\r\n  componentWillUnmount(){\r\n    document.removeEventListener(\"keydown\", this.keyFunction, false);\r\n  }\r\n    \r\n    \r\n      render() {\r\n        console.log(this.props.data);\r\n\r\n        if(this.state.continue === true){\r\n      return <Redirect to=\"/TrialQ\" />\r\n    }\r\n    \r\n        return (\r\n          <div className=\"Complete\">\r\n            <header className=\"Complete-header\">\r\n            <div className=\"text-container\">\r\n              <p className=\"Complete-text\">\r\n                Congratulations\r\n                <br /><br /> You have completed the first trial\r\n                <br /><br /> You responses have been recorded:\r\n                <br /><br />\r\n                Responses:\r\n                { this.props.data.responses_1.map( function( d, idx) { \r\n                  return (<li key={idx} style={{ listStyleType: \"none\"}}>{d}</li>)\r\n                }) }\r\n                Response Times:\r\n                { this.props.data.response_time_1.map( function( d, idx) { \r\n                  return (<li key={idx} style={{ listStyleType: \"none\"}}>{d}</li>)\r\n                }) }\r\n                Contrasts:\r\n                { this.props.data.contrast_1.map( function( d, idx) { \r\n                  return (<li key={idx} style={{ listStyleType: \"none\"}}>{d}</li>)\r\n                }) }\r\n                <br /><br />\r\n              </p>\r\n            </div>     \r\n            </header>\r\n          </div>\r\n        );\r\n      }\r\n    }\r\n\r\nconst mapStateToProps = state => ({\r\n  data: state.data,\r\n})\r\n\r\nexport default connect(mapStateToProps)(Complete)\r\n","import React, { Component } from 'react';\r\nimport './Trial.css';\r\nimport { Redirect } from \"react-router-dom\";\r\nimport { createStim, createGabor } from \"../Stim.js\"\r\nimport { QuestCreate, QuestRecompute, QuestTrials, QuestUpdate, QuestStimulate, QuestMean, QuestMode, QuestSd, QuestP, QuestPdf, QuestQuantile, PAL_Gumbel } from \"../Quest.js\"\r\nimport { ch_QuestBetaAnalysis, process_data } from \"../VisualQuest.js\"\r\n\r\nimport { connect } from 'react-redux'\r\nimport { add_array, add_response_1, add_response_time_1, add_contrast_1 } from '../actions/data'\r\n\r\nclass TrialQ extends Component {\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.keyFunction = this.keyFunction.bind(this);\r\n    this.create_noise = this.create_noise.bind(this);\r\n    this.process_data = this.process_data.bind(this);\r\n    this.gumbel_intensities = this.gumbel_intensities.bind(this);\r\n    this.state = {\r\n      continue: false,\r\n      counter: 0,\r\n      counter2: 0,\r\n      change: false,\r\n\r\n      responses_1: [],\r\n      contrast_array_1: [],\r\n      response_time_1: [],\r\n      ratings_1: [],\r\n\r\n      responses_2: [],\r\n      contrast_array_2: [],\r\n      response_time_2: [],\r\n      ratings_2: [],\r\n\r\n      time_window: false,\r\n      time_window_start: 0,\r\n      time_window_rating: false,\r\n      limit: 100,\r\n\r\n      rating_window: true,\r\n\r\n      currentQ: 1, //1 for contrast 1 and 2 for contrast 2\r\n\r\n    }\r\n    this.canvasRef = React.createRef();\r\n    this.audioContext = new AudioContext();\r\n  }\r\n\r\n  create_noise(audioContext) {\r\n\r\n    var end = 80;\r\n    // var contrast_block = tt1;\r\n    var index1 = 0;\r\n    var index2 = 0;\r\n    var total = 0;\r\n\r\n    //train_test arrays\r\n    var tt1 = [0, .5, 1, 0, .5, 1, 0, .5, 1, 0, .5, 1];\r\n    var end = tt1.length;\r\n    var contrast_block = tt1;\r\n\r\n    var SimplexNoise = require('simplex-noise');\r\n\r\n    var simplex = new SimplexNoise(),\r\n      canvas = document.getElementById('c'),\r\n      ctx = canvas.getContext('2d'),\r\n      imgdata = ctx.getImageData(0, 0, canvas.width, canvas.height),\r\n      data = imgdata.data,\r\n      t = 0;\r\n\r\n    //initializing QUEST\r\n    var tGuess = 0.5,\r\n      tGuessSd = 0.1,\r\n      pThreshold = 0.75,\r\n      beta = 3.5,\r\n      delta = 0.01,\r\n      gamma = 0.01,\r\n      grain = 0.001,\r\n      dim = 1000,\r\n      range = 20;\r\n    var q_1 = QuestCreate(tGuess, tGuessSd, pThreshold, beta, delta, gamma, grain, range);\r\n    var q_2 = QuestCreate(tGuess, tGuessSd, pThreshold, beta, delta, gamma, grain, range);\r\n\r\n    var stim = createStim();\r\n    var stimulus_blank = createGabor(stim, 0);\r\n\r\n    var stimulus;\r\n    var jitter = Math.floor(Math.random() * 20); //jitter tone presentation 0-500ms per trial\r\n    var start_time = 100;\r\n    var contrast = 0;\r\n    var intervalId = undefined;\r\n\r\n    var that = this;\r\n    var seconds = 0;\r\n\r\n    async function vis_quest() {\r\n\r\n      if (t == start_time + jitter) {\r\n\r\n        index1 = that.state.counter;\r\n        index2 = that.state.counter2;\r\n\r\n        total = index1 + index2;\r\n\r\n        console.log(QuestQuantile(q_1), QuestQuantile(q_2));\r\n\r\n        // determining which staircase to use\r\n        if (index1 == index2) {\r\n          that.setState({             //current staircase is 1\r\n            currentQ: 1,\r\n          });\r\n        }\r\n\r\n        if (index1 != index2) {\r\n          index2++;\r\n          that.setState({             //current staircase is 2\r\n            currentQ: 2,\r\n          });\r\n        }\r\n\r\n        if (that.state.currentQ == 1) {\r\n          if (index1 = 0) {\r\n            contrast = tGuess + .3;\r\n          }\r\n          else {\r\n            contrast = QuestQuantile(q_1);\r\n          }\r\n        }\r\n        if (that.state.currentQ == 2) {\r\n          if (index2 = 0) {\r\n            contrast = tGuess - 0.3;\r\n          }\r\n          else {\r\n            contrast = QuestQuantile(q_2);\r\n          }\r\n        }\r\n\r\n        console.log(contrast);\r\n\r\n        var seconds = new Date().getTime() / 1000;\r\n\r\n        console.log(\"time on \", seconds);\r\n\r\n        that.setState({\r\n          time_window: true,\r\n          time_window_rating: true,\r\n          time_window_start: seconds,\r\n        });\r\n\r\n        console.log(\"for 1\", that.state.responses_1, that.state.ratings_1, that.state.response_time_1, that.state.contrast_array_1);\r\n        console.log(\"for 2\", that.state.responses_2, that.state.ratings_2, that.state.response_time_2, that.state.contrast_array_2);\r\n\r\n        stimulus = createGabor(stim, contrast);\r\n        beep(50, 830, 300, audioContext); //beep for arg3 miliseconds\r\n      }\r\n\r\n      for (var x = 0; x < 256; x++) {\r\n        for (var y = 0; y < 256; y++) {\r\n          if (t == start_time + jitter || t == start_time + jitter + 1 || t == start_time + jitter + 2 || t == start_time + jitter + 3 || t == start_time + jitter + 4\r\n            || t == start_time + jitter + 5 || t == start_time + jitter + 6 || t == start_time + jitter + 7 || t == start_time + jitter + 8 || t == start_time + jitter + 9\r\n            || t == start_time + jitter + 10 || t == start_time + jitter + 11 || t == start_time + jitter + 12 || t == start_time + jitter + 13 || t == start_time + jitter + 14\r\n            || t == start_time + jitter + 15 || t == start_time + jitter + 16 || t == start_time + jitter + 17 || t == start_time + jitter + 18 || t == start_time + jitter + 19\r\n            || t == start_time + jitter + 20 || t == start_time + jitter + 21 || t == start_time + jitter + 22 || t == start_time + jitter + 23 || t == start_time + jitter + 24\r\n            || t == start_time + jitter + 25 || t == start_time + jitter + 26 || t == start_time + jitter + 27 || t == start_time + jitter + 28 || t == start_time + jitter + 29\r\n            || t == start_time + jitter + 30) {\r\n            if (t == start_time + jitter + 30) {\r\n              t = 0;\r\n              //during beep show signal, then reset timer to 0\r\n            }\r\n\r\n            var r = simplex.noise3D(x / 8, y / 8, t / 8) * 0.4 + 0.35;\r\n            data[(x + y * 256) * 4 + 0] = stim.alpha * stimulus[(x + y * 256) * 4 + 0] + (1 - stim.alpha) * r * 250;\r\n            data[(x + y * 256) * 4 + 1] = stim.alpha * stimulus[(x + y * 256) * 4 + 1] + (1 - stim.alpha) * r * 250;\r\n            data[(x + y * 256) * 4 + 2] = stim.alpha * stimulus[(x + y * 256) * 4 + 2] + (1 - stim.alpha) * r * 250;\r\n            data[(x + y * 256) * 4 + 3] = 255;\r\n          }\r\n\r\n          else {\r\n\r\n            seconds = new Date().getTime() / 1000\r\n\r\n            if (that.state.time_window_start + 2 == seconds) {\r\n              that.setState({\r\n                time_window: false,\r\n                time_window_rating: false,\r\n              });\r\n\r\n              if (that.state.currentQ == 1) {\r\n\r\n                if (that.state.contrast_array_1.length < that.state.responses_1.length) {\r\n                  that.setState({ contrast_array_1: that.state.contrast_array_1.concat([contrast]) });\r\n                  that.setState({ change: true });\r\n                }\r\n\r\n                if (that.state.responses_1.length != that.state.ratings_1.length) {\r\n\r\n                  if (that.state.responses_1.length > that.state.ratings_1.length) {\r\n\r\n                    console.log(\"response and response time discarded\", that.state.responses_1, that.state.response_time_1, that.state.ratings_1, that.state.contrast_array_1);\r\n\r\n                    that.setState({\r\n                      responses_1: that.state.responses_1.slice(0, that.state.ratings_1.length),\r\n                      response_time_1: that.state.response_time_1.slice(0, that.state.ratings_1.length),\r\n                      counter: that.state.counter - 1,\r\n                      contrast_array_1: that.state.contrast_array_1.slice(0, that.state.ratings_1.length)\r\n                    });\r\n                  }\r\n\r\n                  else {\r\n                    console.log(\"rating discarded\", that.state.responses_1, that.state.ratings_1, that.state.contrast_array_1);\r\n\r\n                    that.setState({\r\n                      ratings_1: that.state.ratings_1.slice(0, that.state.responses_1.length),\r\n                    });\r\n                  }\r\n                }\r\n              }\r\n\r\n              if (that.state.currentQ == 2) {\r\n\r\n                if (that.state.contrast_array_2.length < that.state.responses_2.length) {\r\n                  that.setState({ contrast_array_2: that.state.contrast_array_2.concat([contrast]) });\r\n                  that.setState({ change: true });\r\n                }\r\n\r\n                if (that.state.responses_2.length != that.state.ratings_2.length) {\r\n\r\n                  if (that.state.responses_2.length > that.state.ratings_2.length) {\r\n\r\n                    console.log(\"response and response time discarded\", that.state.responses_2, that.state.response_time_2, that.state.ratings_2, that.state.contrast_array_2);\r\n\r\n                    that.setState({\r\n                      responses_2: that.state.responses_2.slice(0, that.state.ratings_2.length),\r\n                      response_time_2: that.state.response_time_2.slice(0, that.state.ratings_2.length),\r\n                      counter: that.state.counter - 1,\r\n                      contrast_array_2: that.state.contrast_array_2.slice(0, that.state.ratings_2.length)\r\n                    });\r\n                  }\r\n\r\n                  else {\r\n                    console.log(\"rating discarded\", that.state.responses_2, that.state.ratings_2, that.state.contrast_array_2);\r\n\r\n                    that.setState({\r\n                      ratings_2: that.state.ratings_2.slice(0, that.state.responses_2.length),\r\n                    });\r\n                  }\r\n                }\r\n              }\r\n              console.log(\"time off \", seconds);\r\n            }\r\n\r\n\r\n            var r = simplex.noise3D(x / 8, y / 8, t / 8) * 0.4 + 0.35;\r\n            data[(x + y * 256) * 4 + 0] = stim.alpha * stimulus_blank[(x + y * 256) * 4 + 0] + (1 - stim.alpha) * r * 250;\r\n            data[(x + y * 256) * 4 + 1] = stim.alpha * stimulus_blank[(x + y * 256) * 4 + 1] + (1 - stim.alpha) * r * 250;\r\n            data[(x + y * 256) * 4 + 2] = stim.alpha * stimulus_blank[(x + y * 256) * 4 + 2] + (1 - stim.alpha) * r * 250;\r\n            data[(x + y * 256) * 4 + 3] = 255;\r\n            //if there is no beep, show blank signal\r\n          }\r\n        }\r\n      }\r\n\r\n      t++;\r\n      ctx.putImageData(imgdata, 0, 0);\r\n\r\n      var recWidth = canvas.width / 8;\r\n      var recHeight = canvas.height / 8;\r\n\r\n      var xPos = (canvas.width / 2) - (recWidth / 2);\r\n\r\n      var yPos = (canvas.height / 2) - (recHeight / 2);\r\n      var img = new Image();\r\n      img.src = \"https://www.shareicon.net/data/256x256/2015/12/04/682310_cross_512x512.png\";\r\n      ctx.fillStyle = \"gray\";\r\n\r\n      ctx.fillRect(xPos, yPos, recWidth, recHeight);\r\n      ctx.drawImage(img, xPos, yPos, recWidth, recHeight);\r\n\r\n      if (total == end) {\r\n        window.cancelAnimationFrame(intervalId);\r\n        that.audioContext.close();\r\n        that.setState({ continue: true });\r\n        return;\r\n      }\r\n\r\n      if (total < end) {\r\n        intervalId = window.requestAnimationFrame(vis_quest);\r\n\r\n        //console.log(that.state.contrast_array_1, that.state.responses_1);\r\n\r\n        if (that.state.currentQ == 1 && that.state.change == true) {\r\n          console.log(\"changing the q\")\r\n          q_1 = QuestUpdate(q_1, [that.state.contrast_array_1[that.state.contrast_array_1.length - 1]], [that.state.responses_1[that.state.responses_1.length - 1]]);\r\n          console.log(QuestQuantile(q_1));\r\n          that.setState({ change: false });\r\n        }\r\n\r\n        if (that.state.currentQ == 2 && that.state.change == true) {\r\n          q_2 = QuestUpdate(q_2, that.state.contrast_array_1[that.state.contrast_array_1.length - 1], that.state.responses_1[that.state.responses_1.length - 1]);\r\n          that.setState({ change: false });\r\n        }\r\n      }\r\n\r\n    }\r\n\r\n    vis_quest.call(that);\r\n\r\n  }\r\n\r\n  keyFunction(event) {\r\n    var seconds = new Date().getTime() / 1000\r\n\r\n    if (event.keyCode === 81 && this.state.time_window == true && this.state.currentQ == 1) {\r\n\r\n      // Set setState\r\n      this.setState({\r\n        counter: this.state.counter + 1,\r\n        responses_1: this.state.responses_1.concat([1]),\r\n        response_time_1: this.state.response_time_1.concat([seconds - this.state.time_window_start]),\r\n        time_window: false,\r\n      });\r\n\r\n      if (this.state.counter == this.state.limit) {\r\n        this.setState({ continue: true });\r\n      }\r\n\r\n    }\r\n\r\n    if (event.keyCode === 81 && this.state.time_window == true && this.state.currentQ == 2) {\r\n\r\n      // Set setState\r\n      this.setState({\r\n        counter2: this.state.counter2 + 1,\r\n        responses_2: this.state.responses_2.concat([1]),\r\n        response_time_2: this.state.response_time_2.concat([seconds - this.state.time_window_start]),\r\n        time_window: false,\r\n      });\r\n\r\n      if (this.state.counter == this.state.limit) {\r\n        this.setState({ continue: true });\r\n      }\r\n\r\n    }\r\n\r\n    if (event.keyCode === 69 && this.state.time_window == true && this.state.currentQ == 1) {\r\n      this.setState({\r\n        counter: this.state.counter + 1,\r\n        responses_1: this.state.responses_1.concat([0]),\r\n        response_time_1: this.state.response_time_1.concat([seconds - this.state.time_window_start]),\r\n        time_window: false,\r\n      });\r\n\r\n      if (this.state.counter == this.state.limit) {\r\n        this.setState({ continue: true });\r\n      }\r\n    }\r\n\r\n    if (event.keyCode === 69 && this.state.time_window == true && this.state.currentQ == 2) {\r\n      this.setState({\r\n        counter: this.state.counter2 + 1,\r\n        responses_2: this.state.responses_2.concat([0]),\r\n        response_time_2: this.state.response_time_2.concat([seconds - this.state.time_window_start]),\r\n        time_window: false,\r\n      });\r\n\r\n      if (this.state.counter == this.state.limit) {\r\n        this.setState({ continue: true });\r\n      }\r\n    }\r\n\r\n\r\n    if ((event.keyCode === 49 || event.keyCode === 50 || event.keyCode === 51 || event.keyCode === 52 || event.keyCode === 53) && this.state.time_window_rating == true) {\r\n      if (this.state.currentQ == 1) {\r\n        this.setState({\r\n          ratings_1: this.state.ratings_1.concat([event.keyCode - 48]),\r\n          time_window_rating: false,\r\n        });\r\n      }\r\n      else {\r\n        this.setState({\r\n          ratings_2: this.state.ratings_2.concat([event.keyCode - 48]),\r\n          time_window_rating: false,\r\n        });\r\n      }\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    document.addEventListener(\"keydown\", this.keyFunction, false);\r\n    if (this.state.continue == false) {\r\n      this.create_noise(this.audioContext);\r\n    }\r\n  }\r\n  componentWillUnmount() {\r\n    document.removeEventListener(\"keydown\", this.keyFunction, false);\r\n  }\r\n\r\n  render() {\r\n\r\n    if (this.state.continue == true) {\r\n      alert(\"Trial completed\")\r\n      return <Redirect to=\"/Complete\" />\r\n    }\r\n\r\n    return (\r\n      <div className=\"Trial\">\r\n        <input type=\"hidden\" />\r\n        <header className=\"Trial-header\">\r\n          <canvas id=\"c\" width=\"256\" height=\"256\"\r\n            style={{ zIndex: \"0\", position: \"fixed\", left: \"25%\", width: '50%', height: 'auto' }}></canvas>\r\n          <canvas id=\"c2\" width=\"256\" height=\"256\"\r\n            style={{ zIndex: \"1\", position: \"fixed\", left: \"25%\", width: '50%', height: 'auto' }}></canvas>\r\n        </header>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = state => ({\r\n  data: state.data,\r\n})\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  add_response_1: (element) => dispatch(add_response_1(element)),\r\n  add_response_time_1: (element) => dispatch(add_response_time_1(element)),\r\n  add_contrast_1: (element) => dispatch(add_contrast_1(element)),\r\n  add_array: (arr) => dispatch(add_array(arr)),\r\n})\r\n\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(TrialQ);\r\n\r\n\r\nfunction beep(amp, freq, ms, audioContext) {//amp:0..100, freq in Hz, ms\r\n  if (!audioContext) return;\r\n  var osc = audioContext.createOscillator();\r\n  var gain = audioContext.createGain();\r\n  osc.connect(gain);\r\n  osc.value = freq;\r\n  gain.connect(audioContext.destination);\r\n  gain.gain.value = amp / 100;\r\n  osc.start(audioContext.currentTime);\r\n  osc.stop(audioContext.currentTime + ms / 1000);\r\n}\r\n\r\n//array shuffling function, used to randomize order of presentation for different blocks\r\nfunction shuffle(array) {\r\n  var i = 0\r\n  var j = 0\r\n  var temp = null\r\n\r\n  for (i = array.length - 1; i > 0; i -= 1) {\r\n    j = Math.floor(Math.random() * (i + 1))\r\n    temp = array[i]\r\n    array[i] = array[j]\r\n    array[j] = temp\r\n  }\r\n}\r\n\r\n","import React from \"react\";\r\nimport { Route, Switch } from \"react-router-dom\";\r\nimport Welcome from \"./containers/Welcome\";\r\nimport Instructions from \"./containers/Instructions\";\r\nimport Trial from \"./containers/Trial\";\r\nimport NotFound from \"./containers/NotFound\";\r\nimport Complete from \"./containers/Complete\";\r\nimport TrialQ from \"./containers/TrialQ\";\r\n\r\nexport default () =>\r\n  <Switch>\r\n    <Route path=\"/users/:id\"  exact component={Welcome} />\r\n    <Route path=\"/\" exact component={Welcome} />\r\n    <Route path=\"/Welcome\" exact component={Welcome} />\r\n    <Route path=\"/Instructions\" exact component={Instructions} />\r\n    <Route path=\"/Trial\" exact component={Trial} />\r\n    <Route path=\"/Complete\" exact component={Complete} />\r\n    <Route path=\"/TrialQ\" exact component={TrialQ} />\r\n        { /* Finally, catch all unmatched routes */ }\r\n    <Route component={NotFound} />\r\n  </Switch>;","import React, { Component } from 'react';\nimport './App.css';\nimport Routes from \"./Routes\";\n\nclass App extends Component {\n\n  render() {\n\n    return (\n      <div>\n        <Routes />\n      </div>\n    );\n  }\n}\n\nexport default App;\n","const initialState = {\r\n  responses_1 :[],\r\n  responses_2 :[],\r\n\r\n  response_time_1 :[],\r\n  response_time_2 :[],\r\n\r\n  contrast_1 :[],\r\n  contrast_2 :[],\r\n  test: 1, \r\n}\r\n\r\n\r\nconst rtReducer = (state = initialState, action) => {\r\n    switch (action.type) {\r\n      case 'ADD_ARRAY':\r\n        return state + 1\r\n      case 'ADD_RESPONSE_1':\r\n        return {\r\n          ...state,\r\n          responses_1: [...state.responses_1, action.payload]\r\n        }\r\n      case 'ADD_RESPONSE_TIME_1':\r\n        return {\r\n          ...state,\r\n          response_time_1: [...state.response_time_1, action.payload]\r\n        }\r\n      case 'ADD_CONTRAST_1':\r\n        return {\r\n          ...state,\r\n          contrast_1: [...state.contrast_1, action.payload]\r\n        }\r\n      default:\r\n        return state\r\n    }\r\n  }\r\n  \r\n  export default rtReducer","import { combineReducers } from 'redux'\nimport { connectRouter } from 'connected-react-router'\nimport rtReducer from './data'\n\nconst rootReducer = (history) => combineReducers({\n  data: rtReducer,\n  router: connectRouter(history)\n})\n\nexport default rootReducer","import { createBrowserHistory } from 'history'\r\nimport { applyMiddleware, compose, createStore } from 'redux'\r\nimport { routerMiddleware } from 'connected-react-router'\r\nimport createRootReducer from './reducers'\r\n\r\nexport const history = createBrowserHistory()\r\n\r\nexport default function configureStore(preloadedState) {\r\n  const composeEnhancer = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose\r\n  const store = createStore(\r\n    createRootReducer(history),\r\n    preloadedState,\r\n    composeEnhancer(\r\n      applyMiddleware(\r\n        routerMiddleware(history),\r\n      ),\r\n    ),\r\n  )\r\n\r\n  // Hot reloading\r\n  if (module.hot) {\r\n    // Enable Webpack hot module replacement for reducers\r\n    module.hot.accept('./reducers', () => {\r\n      store.replaceReducer(createRootReducer(history));\r\n    });\r\n  }\r\n\r\n  return store\r\n}","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport { BrowserRouter as Router } from \"react-router-dom\";\n\nimport { createStore, combineReducers } from 'redux'\nimport { Provider } from 'react-redux'\nimport configureStore, { history } from './configureStore'\n\n\nconst store = configureStore( { history } );\n\nReactDOM.render(\n\t<Provider store={store}>\n\t    <Router history={history} basename={process.env.PUBLIC_URL}>\n\t      <App />\n\t    </Router>\n\t</Provider>, \n    document.getElementById(\"root\")\n  );\n"],"sourceRoot":""}